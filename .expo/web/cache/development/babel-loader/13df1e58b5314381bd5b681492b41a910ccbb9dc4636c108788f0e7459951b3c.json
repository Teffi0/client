{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport axios from 'axios';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { BackIcon, EditIcon, DeleteIcon, None, DocumentIcon } from \"../icons\";\nimport styles from \"../styles/styles\";\nimport { debounce } from 'lodash';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Pagination = React.memo(function (_ref) {\n  var currentPage = _ref.currentPage,\n    totalPages = _ref.totalPages,\n    onPageChange = _ref.onPageChange;\n  var pages = React.useMemo(function () {\n    return Array.from({\n      length: totalPages\n    }, function (_, i) {\n      return i + 1;\n    });\n  }, [totalPages]);\n  return _jsx(View, {\n    style: {\n      flexDirection: 'row',\n      justifyContent: 'center'\n    },\n    children: pages.map(function (page) {\n      return _jsx(TouchableOpacity, {\n        onPress: function onPress() {\n          return onPageChange(page);\n        },\n        children: _jsx(Text, {\n          style: {\n            marginHorizontal: 8,\n            color: currentPage === page ? 'blue' : 'black'\n          },\n          children: page\n        })\n      }, page);\n    })\n  });\n});\nvar ChangeHistoryModal = function ChangeHistoryModal(_ref2) {\n  var isVisible = _ref2.isVisible,\n    onClose = _ref2.onClose;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    history = _useState2[0],\n    setHistory = _useState2[1];\n  useEffect(function () {\n    var fetchHistory = function () {\n      var _ref3 = _asyncToGenerator(function* () {\n        try {\n          var response = yield axios.get(`http://31.129.101.174/inventory/changes/all`);\n          setHistory(response.data);\n        } catch (error) {\n          console.error('Ошибка при получении истории изменений инвентаря:', error);\n        }\n      });\n      return function fetchHistory() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    if (isVisible) {\n      fetchHistory();\n    }\n  }, [isVisible]);\n  return _jsx(Modal, {\n    isVisible: isVisible,\n    onBackdropPress: onClose,\n    children: _jsx(SafeAreaView, {\n      style: styles.container,\n      children: _jsxs(ScrollView, {\n        children: [_jsx(View, {\n          style: styles.contentContainerTask,\n          children: _jsxs(View, {\n            style: styles.taskHeader,\n            children: [_jsx(TouchableOpacity, {\n              onPress: onClose,\n              children: _jsx(BackIcon, {})\n            }), _jsx(Text, {\n              style: [styles.titleMedium, {\n                flex: 1,\n                textAlign: 'center'\n              }],\n              children: \"\\u0416\\u0443\\u0440\\u043D\\u0430\\u043B \\u0438\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0439\"\n            }), _jsx(TouchableOpacity, {\n              children: _jsx(None, {})\n            })]\n          })\n        }), history.map(function (change, index) {\n          return _jsxs(View, {\n            style: styles.historyItem,\n            children: [_jsxs(Text, {\n              children: [\"\\u0414\\u0430\\u0442\\u0430: \", change.change_timestamp]\n            }), _jsxs(Text, {\n              children: [\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435: \", change.change_description]\n            }), _jsxs(Text, {\n              children: [\"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C: \", change.user_id]\n            })]\n          }, index);\n        })]\n      })\n    })\n  });\n};\nvar InventoryScreen = function InventoryScreen() {\n  var navigation = useNavigation();\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    inventory = _useState4[0],\n    setInventory = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    searchQuery = _useState6[0],\n    setSearchQuery = _useState6[1];\n  var _useState7 = useState([]),\n    _useState8 = _slicedToArray(_useState7, 2),\n    selectedItems = _useState8[0],\n    setSelectedItems = _useState8[1];\n  var _useState9 = useState(false),\n    _useState10 = _slicedToArray(_useState9, 2),\n    isEditing = _useState10[0],\n    setIsEditing = _useState10[1];\n  var _useState11 = useState({}),\n    _useState12 = _slicedToArray(_useState11, 2),\n    editableItems = _useState12[0],\n    setEditableItems = _useState12[1];\n  var _useState13 = useState(1),\n    _useState14 = _slicedToArray(_useState13, 2),\n    currentPage = _useState14[0],\n    setCurrentPage = _useState14[1];\n  var _useState15 = useState(0),\n    _useState16 = _slicedToArray(_useState15, 2),\n    totalPages = _useState16[0],\n    setTotalPages = _useState16[1];\n  var limit = 10;\n  var _useState17 = useState(false),\n    _useState18 = _slicedToArray(_useState17, 2),\n    isHistoryModalVisible = _useState18[0],\n    setIsHistoryModalVisible = _useState18[1];\n  useEffect(function () {\n    fetchInventory();\n  }, [currentPage]);\n  useEffect(function () {\n    if (selectedItems.length === 0 && isEditing) {\n      clearEditingState();\n    }\n  }, [selectedItems, isEditing]);\n  var fetchInventory = useCallback(_asyncToGenerator(function* () {\n    try {\n      var response = yield axios.get('http://31.129.101.174/inventory', {\n        params: {\n          page: currentPage,\n          limit: limit\n        }\n      });\n      setInventory(response.data);\n      setTotalPages(response.data.totalPages);\n    } catch (error) {\n      console.error('Ошибка при загрузке инвентаря:', error);\n    }\n  }), [currentPage]);\n  var openHistoryModal = function openHistoryModal() {\n    return setIsHistoryModalVisible(true);\n  };\n  var debouncedSearch = useCallback(debounce(function (query) {\n    if (!query) {\n      fetchInventory();\n    } else {\n      var lowercasedQuery = query.toLowerCase();\n      setInventory(inventory.filter(function (item) {\n        return item.name.toLowerCase().includes(lowercasedQuery);\n      }));\n    }\n  }, 300), [inventory]);\n  useEffect(function () {\n    debouncedSearch(searchQuery);\n  }, [searchQuery]);\n  var handleSearchChange = function handleSearchChange(text) {\n    return setSearchQuery(text);\n  };\n  var handleModalFormSubmit = useCallback(function () {\n    var _ref5 = _asyncToGenerator(function* (itemData) {\n      if (!itemData.name || !itemData.measure) {\n        Alert.alert('Ошибка', 'Все поля должны быть заполнены.');\n        return;\n      }\n      var dataToSend = {\n        name: itemData.name,\n        measure: itemData.measure,\n        quantity: itemData.quantity\n      };\n      try {\n        if (itemData.id && itemData.id !== 'new') {\n          yield axios.put(`http://31.129.101.174/inventory/${itemData.id}`, dataToSend);\n        } else {\n          yield axios.post('http://31.129.101.174/inventory', dataToSend);\n        }\n        fetchInventory();\n        clearEditingState();\n      } catch (error) {\n        console.error('Ошибка при обработке данных инвентаря:', error);\n        Alert.alert('Ошибка', 'Произошла ошибка при обработке данных инвентаря.');\n      }\n    });\n    return function (_x) {\n      return _ref5.apply(this, arguments);\n    };\n  }(), [fetchInventory, clearEditingState]);\n  var clearEditingState = function clearEditingState() {\n    setIsEditing(false);\n    setEditableItems({});\n    setSelectedItems([]);\n  };\n  var handleButtonPress = React.useCallback(_asyncToGenerator(function* () {\n    if (isEditing) {\n      try {\n        yield Promise.all(Object.values(editableItems).map(function () {\n          var _ref7 = _asyncToGenerator(function* (itemData) {\n            yield handleModalFormSubmit(itemData);\n          });\n          return function (_x2) {\n            return _ref7.apply(this, arguments);\n          };\n        }()));\n        yield fetchInventory();\n        clearEditingState();\n      } catch (error) {\n        console.error('Ошибка при обновлении данных инвентаря:', error);\n        Alert.alert('Ошибка', 'Произошла ошибка при обновлении данных инвентаря');\n      }\n    } else {\n      var newItemId = 9999999;\n      var newItemData = {\n        id: 'newItemId',\n        name: '',\n        measure: '',\n        quantity: 0\n      };\n      setInventory(function (prevItems) {\n        return [].concat(_toConsumableArray(prevItems), [newItemData]);\n      });\n      setEditableItems(_defineProperty({}, newItemId, newItemData));\n      setIsEditing(true);\n      setSelectedItems([newItemId]);\n    }\n  }), [isEditing, editableItems]);\n  var handleItemDataChange = function handleItemDataChange(itemId, key, value) {\n    setEditableItems(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, _defineProperty({}, itemId, _objectSpread(_objectSpread({}, prev[itemId]), {}, _defineProperty({}, key, value))));\n    });\n  };\n  var handleEditPress = function handleEditPress() {\n    if (selectedItems.length > 0) {\n      var editable = selectedItems.reduce(function (acc, itemId) {\n        var item = inventory.find(function (i) {\n          return i.id === itemId;\n        });\n        if (item) {\n          acc[itemId] = _objectSpread({}, item);\n        }\n        return acc;\n      }, {});\n      setEditableItems(editable);\n      setIsEditing(true);\n    } else {\n      Alert.alert('Выберите элемент', 'Для редактирования выберите элемент из списка.');\n    }\n  };\n  var handleDeleteItem = function () {\n    var _ref8 = _asyncToGenerator(function* (itemId) {\n      try {\n        yield axios.delete(`http://31.129.101.174/inventory/${itemId}`);\n        fetchInventory();\n      } catch (error) {\n        console.error('Ошибка при удалении элемента инвентаря:', error);\n      }\n    });\n    return function handleDeleteItem(_x3) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n  var handleSelectItem = function handleSelectItem(itemId) {\n    setSelectedItems(function (prevSelected) {\n      var newSelectedItems = prevSelected.includes(itemId) ? prevSelected.filter(function (id) {\n        return id !== itemId;\n      }) : [].concat(_toConsumableArray(prevSelected), [itemId]);\n      return newSelectedItems;\n    });\n  };\n  var handleSelectAllItems = function handleSelectAllItems() {\n    if (selectedItems.length === inventory.length) {\n      setSelectedItems([]);\n    } else {\n      setSelectedItems(inventory.map(function (item) {\n        return item.id;\n      }));\n    }\n  };\n  var renderRow = useCallback(function (_ref9) {\n    var item = _ref9.item;\n    return _jsxs(View, {\n      style: styles.row,\n      children: [_jsx(View, {\n        style: styles.headercheckboxTableCell,\n        children: _jsx(TouchableOpacity, {\n          style: styles.checkboxTable,\n          onPress: function onPress() {\n            return handleSelectItem(item.id);\n          },\n          children: selectedItems.includes(item.id) && _jsx(View, {\n            style: styles.checkboxTableSelected\n          })\n        })\n      }), editableItems[item.id] ? _jsxs(React.Fragment, {\n        children: [_jsx(TextInput, {\n          style: styles.cell,\n          value: editableItems[item.id].name,\n          onChangeText: function onChangeText(text) {\n            return handleItemDataChange(item.id, 'name', text);\n          }\n        }), _jsx(TextInput, {\n          style: styles.cell,\n          value: editableItems[item.id].measure,\n          onChangeText: function onChangeText(text) {\n            return handleItemDataChange(item.id, 'measure', text);\n          }\n        }), _jsx(TextInput, {\n          style: styles.cell,\n          value: String(editableItems[item.id].quantity),\n          onChangeText: function onChangeText(text) {\n            return handleItemDataChange(item.id, 'quantity', text);\n          },\n          keyboardType: \"numeric\"\n        })]\n      }) : _jsxs(React.Fragment, {\n        children: [_jsx(Text, {\n          style: styles.cell,\n          children: item.name\n        }), _jsx(Text, {\n          style: styles.cell,\n          children: item.measure\n        }), _jsx(Text, {\n          style: styles.cell,\n          children: item.quantity\n        })]\n      })]\n    });\n  }, [editableItems, selectedItems]);\n  var handleBackPress = function handleBackPress() {\n    if (isEditing) {\n      if (selectedItems.length === 0) {\n        confirmCancelEditing();\n      } else {\n        Alert.alert(\"Предупреждение\", \"Данные могут не сохраниться. Отменить редактирование?\", [{\n          text: \"Нет\"\n        }, {\n          text: \"Да\",\n          onPress: confirmCancelEditing\n        }], {\n          cancelable: false\n        });\n      }\n    } else {\n      navigation.goBack();\n    }\n  };\n  var confirmCancelEditing = function confirmCancelEditing() {\n    setIsEditing(false);\n    setEditableItems({});\n    setSelectedItems([]);\n  };\n  return _jsx(SafeAreaView, {\n    style: styles.container,\n    children: _jsxs(View, {\n      style: styles.contentContainerTask,\n      children: [_jsxs(View, {\n        style: styles.taskHeader,\n        children: [_jsx(TouchableOpacity, {\n          onPress: handleBackPress,\n          children: _jsx(BackIcon, {})\n        }), _jsx(Text, {\n          style: [styles.titleMedium, {\n            flex: 1,\n            textAlign: 'center'\n          }],\n          children: \"\\u0421\\u043A\\u043B\\u0430\\u0434\"\n        }), selectedItems.length === 0 ? _jsx(TouchableOpacity, {\n          onPress: openHistoryModal,\n          children: _jsx(DocumentIcon, {})\n        }) : isEditing ? _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return handleDeleteItem(selectedItems[0]);\n          },\n          children: _jsx(DeleteIcon, {})\n        }) : _jsx(TouchableOpacity, {\n          onPress: handleEditPress,\n          children: _jsx(EditIcon, {})\n        })]\n      }), _jsx(TextInput, {\n        style: styles.searchInput,\n        placeholder: \"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u0441\\u043A\\u043B\\u0430\\u0434\\u0443\",\n        onChangeText: handleSearchChange,\n        value: searchQuery\n      }), isHistoryModalVisible && _jsx(ChangeHistoryModal, {\n        isVisible: isHistoryModalVisible,\n        onClose: function onClose() {\n          return setIsHistoryModalVisible(false);\n        }\n      }), _jsx(ScrollView, {\n        horizontal: true,\n        overScrollMode: \"never\",\n        children: _jsx(SafeAreaView, {\n          children: _jsx(FlatList, {\n            data: inventory,\n            keyExtractor: function keyExtractor(item) {\n              return String(item.id);\n            },\n            renderItem: renderRow,\n            ListHeaderComponent: _jsxs(View, {\n              style: styles.headerTable,\n              children: [_jsx(View, {\n                style: styles.headercheckboxTableCell,\n                children: _jsx(TouchableOpacity, {\n                  style: styles.checkboxTable,\n                  onPress: handleSelectAllItems,\n                  children: selectedItems.length === inventory.length ? _jsx(View, {\n                    style: styles.checkboxTableSelected\n                  }) : null\n                })\n              }), _jsx(Text, {\n                style: styles.headerCell,\n                children: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"\n              }), _jsx(Text, {\n                style: styles.headerCell,\n                children: \"\\u0415\\u0434\\u0438\\u043D\\u0438\\u0446\\u0430 \\u0438\\u0437\\u043C\\u0435\\u0440\\u0435\\u043D\\u0438\\u044F\"\n              }), _jsx(Text, {\n                style: styles.headerCell,\n                children: \"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"\n              })]\n            }),\n            ListFooterComponent: _jsx(Pagination, {\n              currentPage: currentPage,\n              totalPages: totalPages,\n              onPageChange: setCurrentPage\n            })\n          })\n        })\n      }), _jsx(TouchableOpacity, {\n        style: styles.addButton,\n        onPress: handleButtonPress,\n        children: _jsx(Text, {\n          style: styles.addButtonText,\n          children: isEditing ? \"Применить изменения\" : \"Добавить предмет\"\n        })\n      })]\n    })\n  });\n};\nexport default InventoryScreen;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","View","Text","FlatList","ScrollView","Button","Alert","TextInput","TouchableOpacity","Modal","axios","SafeAreaView","useNavigation","BackIcon","EditIcon","DeleteIcon","None","DocumentIcon","styles","debounce","jsx","_jsx","jsxs","_jsxs","Pagination","memo","_ref","currentPage","totalPages","onPageChange","pages","Array","from","length","_","i","style","flexDirection","justifyContent","children","map","page","onPress","marginHorizontal","color","ChangeHistoryModal","_ref2","isVisible","onClose","_useState","_useState2","_slicedToArray","history","setHistory","fetchHistory","_ref3","_asyncToGenerator","response","get","data","error","console","apply","arguments","onBackdropPress","container","contentContainerTask","taskHeader","titleMedium","flex","textAlign","change","index","historyItem","change_timestamp","change_description","user_id","InventoryScreen","navigation","_useState3","_useState4","inventory","setInventory","_useState5","_useState6","searchQuery","setSearchQuery","_useState7","_useState8","selectedItems","setSelectedItems","_useState9","_useState10","isEditing","setIsEditing","_useState11","_useState12","editableItems","setEditableItems","_useState13","_useState14","setCurrentPage","_useState15","_useState16","setTotalPages","limit","_useState17","_useState18","isHistoryModalVisible","setIsHistoryModalVisible","fetchInventory","clearEditingState","params","openHistoryModal","debouncedSearch","query","lowercasedQuery","toLowerCase","filter","item","name","includes","handleSearchChange","text","handleModalFormSubmit","_ref5","itemData","measure","alert","dataToSend","quantity","id","put","post","_x","handleButtonPress","Promise","all","Object","values","_ref7","_x2","newItemId","newItemData","prevItems","concat","_toConsumableArray","_defineProperty","handleItemDataChange","itemId","key","value","prev","_objectSpread","handleEditPress","editable","reduce","acc","find","handleDeleteItem","_ref8","delete","_x3","handleSelectItem","prevSelected","newSelectedItems","handleSelectAllItems","renderRow","_ref9","row","headercheckboxTableCell","checkboxTable","checkboxTableSelected","Fragment","cell","onChangeText","String","keyboardType","handleBackPress","confirmCancelEditing","cancelable","goBack","searchInput","placeholder","horizontal","overScrollMode","keyExtractor","renderItem","ListHeaderComponent","headerTable","headerCell","ListFooterComponent","addButton","addButtonText"],"sources":["C:/Users/fred/Desktop/crm/src/screens/InventoryScreen.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { View, Text, FlatList, ScrollView, Button, Alert, TextInput, TouchableOpacity, Modal } from 'react-native';\r\nimport axios from 'axios';\r\nimport { SafeAreaView } from 'react-native-safe-area-context';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { BackIcon, EditIcon, DeleteIcon, None, DocumentIcon } from '../icons';\r\nimport styles from '../styles/styles';\r\nimport { debounce } from 'lodash';\r\n\r\nconst Pagination = React.memo(({ currentPage, totalPages, onPageChange }) => {\r\n  const pages = React.useMemo(() => {\r\n    return Array.from({ length: totalPages }, (_, i) => i + 1);\r\n  }, [totalPages]);\r\n\r\n  return (\r\n    <View style={{ flexDirection: 'row', justifyContent: 'center' }}>\r\n      {pages.map(page => (\r\n        <TouchableOpacity key={page} onPress={() => onPageChange(page)}>\r\n          <Text style={{ marginHorizontal: 8, color: currentPage === page ? 'blue' : 'black' }}>\r\n            {page}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      ))}\r\n    </View>\r\n  );\r\n});\r\n\r\nconst ChangeHistoryModal = ({ isVisible, onClose }) => {\r\n  const [history, setHistory] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchHistory = async () => {\r\n      try {\r\n        const response = await axios.get(`http://31.129.101.174/inventory/changes/all`);\r\n        setHistory(response.data);\r\n      } catch (error) {\r\n        console.error('Ошибка при получении истории изменений инвентаря:', error);\r\n      }\r\n    };\r\n\r\n    if (isVisible) {\r\n      fetchHistory();\r\n    }\r\n  }, [isVisible]);\r\n\r\n  return (\r\n    <Modal isVisible={isVisible} onBackdropPress={onClose}>\r\n      <SafeAreaView style={styles.container}>\r\n        <ScrollView>\r\n          <View style={styles.contentContainerTask}>\r\n            <View style={styles.taskHeader}>\r\n              <TouchableOpacity onPress={onClose}>\r\n                <BackIcon />\r\n              </TouchableOpacity>\r\n              <Text style={[styles.titleMedium, { flex: 1, textAlign: 'center' }]}>Журнал изменений</Text>\r\n              <TouchableOpacity>\r\n                <None />\r\n              </TouchableOpacity>\r\n            </View>\r\n          </View>\r\n          {history.map((change, index) => (\r\n            <View key={index} style={styles.historyItem}>\r\n              <Text>Дата: {change.change_timestamp}</Text>\r\n              <Text>Описание: {change.change_description}</Text>\r\n              <Text>Пользователь: {change.user_id}</Text>\r\n            </View>\r\n          ))}\r\n        </ScrollView>\r\n      </SafeAreaView>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst InventoryScreen = () => {\r\n  const navigation = useNavigation();\r\n  const [inventory, setInventory] = useState([]);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedItems, setSelectedItems] = useState([]);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editableItems, setEditableItems] = useState({});\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const limit = 10;\r\n  const [isHistoryModalVisible, setIsHistoryModalVisible] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchInventory();\r\n  }, [currentPage]);\r\n\r\n  useEffect(() => {\r\n    if (selectedItems.length === 0 && isEditing) {\r\n      clearEditingState();\r\n    }\r\n  }, [selectedItems, isEditing]);\r\n\r\n  const fetchInventory = useCallback(async () => {\r\n    try {\r\n      const response = await axios.get('http://31.129.101.174/inventory', {\r\n        params: { page: currentPage, limit }\r\n      });\r\n      setInventory(response.data);\r\n      setTotalPages(response.data.totalPages);\r\n    } catch (error) {\r\n      console.error('Ошибка при загрузке инвентаря:', error);\r\n    }\r\n  }, [currentPage]);\r\n\r\n  const openHistoryModal = () => setIsHistoryModalVisible(true);\r\n\r\n  const debouncedSearch = useCallback(debounce((query) => {\r\n    if (!query) {\r\n      fetchInventory();\r\n    } else {\r\n      const lowercasedQuery = query.toLowerCase();\r\n      setInventory(inventory.filter(item =>\r\n        item.name.toLowerCase().includes(lowercasedQuery)\r\n      ));\r\n    }\r\n  }, 300), [inventory]);\r\n\r\n\r\n  useEffect(() => {\r\n    debouncedSearch(searchQuery);\r\n  }, [searchQuery]);\r\n\r\n  const handleSearchChange = (text) => setSearchQuery(text);\r\n\r\n  const handleModalFormSubmit = useCallback(async (itemData) => {\r\n    // Проверка данных элемента инвентаря перед отправкой\r\n    if (!itemData.name || !itemData.measure) {\r\n      Alert.alert('Ошибка', 'Все поля должны быть заполнены.');\r\n      return;\r\n    }\r\n\r\n    // Формирование данных для отправки на сервер\r\n    const dataToSend = {\r\n      name: itemData.name,\r\n      measure: itemData.measure,\r\n      quantity: itemData.quantity,\r\n    };\r\n\r\n    try {\r\n      if (itemData.id && itemData.id !== 'new') {\r\n        await axios.put(`http://31.129.101.174/inventory/${itemData.id}`, dataToSend);\r\n      } else {\r\n        await axios.post('http://31.129.101.174/inventory', dataToSend);\r\n      }\r\n      fetchInventory();\r\n      clearEditingState();\r\n    } catch (error) {\r\n      console.error('Ошибка при обработке данных инвентаря:', error);\r\n      Alert.alert('Ошибка', 'Произошла ошибка при обработке данных инвентаря.');\r\n    }\r\n  }, [fetchInventory, clearEditingState]);\r\n\r\n  const clearEditingState = () => {\r\n    setIsEditing(false);\r\n    setEditableItems({});\r\n    setSelectedItems([]);\r\n  };\r\n\r\n  const handleButtonPress = React.useCallback(async () => {\r\n    if (isEditing) {\r\n      try {\r\n        await Promise.all(Object.values(editableItems).map(async (itemData) => {\r\n          await handleModalFormSubmit(itemData);\r\n        }));\r\n\r\n        await fetchInventory();\r\n\r\n        clearEditingState();\r\n      } catch (error) {\r\n        console.error('Ошибка при обновлении данных инвентаря:', error);\r\n        Alert.alert('Ошибка', 'Произошла ошибка при обновлении данных инвентаря');\r\n      }\r\n    } else {\r\n      const newItemId = 9999999;\r\n      const newItemData = {\r\n        id: 'newItemId', // Используйте временный ID для нового элемента\r\n        name: '',\r\n        measure: '',\r\n        quantity: 0\r\n      };\r\n\r\n      setInventory(prevItems => [...prevItems, newItemData]);\r\n      setEditableItems({ [newItemId]: newItemData });\r\n      setIsEditing(true);\r\n      setSelectedItems([newItemId]);\r\n    }\r\n  }, [isEditing, editableItems]);\r\n\r\n  const handleItemDataChange = (itemId, key, value) => {\r\n    setEditableItems(prev => ({\r\n      ...prev,\r\n      [itemId]: {\r\n        ...prev[itemId],\r\n        [key]: value\r\n      }\r\n    }));\r\n  };\r\n\r\n  const handleEditPress = () => {\r\n    if (selectedItems.length > 0) {\r\n      const editable = selectedItems.reduce((acc, itemId) => {\r\n        const item = inventory.find(i => i.id === itemId);\r\n        if (item) {\r\n          acc[itemId] = { ...item };\r\n        }\r\n        return acc;\r\n      }, {});\r\n\r\n      setEditableItems(editable);\r\n      setIsEditing(true);\r\n    } else {\r\n      Alert.alert('Выберите элемент', 'Для редактирования выберите элемент из списка.');\r\n    }\r\n  };\r\n\r\n  const handleDeleteItem = async (itemId) => {\r\n    try {\r\n      await axios.delete(`http://31.129.101.174/inventory/${itemId}`);\r\n      fetchInventory();\r\n    } catch (error) {\r\n      console.error('Ошибка при удалении элемента инвентаря:', error);\r\n    }\r\n  };\r\n\r\n  const handleSelectItem = (itemId) => {\r\n    setSelectedItems(prevSelected => {\r\n      const newSelectedItems = prevSelected.includes(itemId)\r\n        ? prevSelected.filter(id => id !== itemId)\r\n        : [...prevSelected, itemId];\r\n      return newSelectedItems;\r\n    });\r\n  };\r\n\r\n  const handleSelectAllItems = () => {\r\n    if (selectedItems.length === inventory.length) {\r\n      setSelectedItems([]);\r\n    } else {\r\n      setSelectedItems(inventory.map(item => item.id));\r\n    }\r\n  };\r\n\r\n  const renderRow = useCallback(({ item }) => (\r\n    <View style={styles.row}>\r\n      <View style={styles.headercheckboxTableCell}>\r\n        <TouchableOpacity\r\n          style={styles.checkboxTable}\r\n          onPress={() => handleSelectItem(item.id)}\r\n        >\r\n          {selectedItems.includes(item.id) && <View style={styles.checkboxTableSelected} />}\r\n        </TouchableOpacity>\r\n      </View>\r\n      {editableItems[item.id] ? (\r\n        <React.Fragment>\r\n          <TextInput\r\n            style={styles.cell}\r\n            value={editableItems[item.id].name}\r\n            onChangeText={(text) => handleItemDataChange(item.id, 'name', text)}\r\n          />\r\n          <TextInput\r\n            style={styles.cell}\r\n            value={editableItems[item.id].measure}\r\n            onChangeText={(text) => handleItemDataChange(item.id, 'measure', text)}\r\n          />\r\n          <TextInput\r\n            style={styles.cell}\r\n            value={String(editableItems[item.id].quantity)}\r\n            onChangeText={(text) => handleItemDataChange(item.id, 'quantity', text)}\r\n            keyboardType='numeric'\r\n          />\r\n        </React.Fragment>\r\n      ) : (\r\n        <React.Fragment>\r\n          <Text style={styles.cell}>{item.name}</Text>\r\n          <Text style={styles.cell}>{item.measure}</Text>\r\n          <Text style={styles.cell}>{item.quantity}</Text>\r\n        </React.Fragment>\r\n      )}\r\n    </View>\r\n  ), [editableItems, selectedItems]);\r\n\r\n  const handleBackPress = () => {\r\n    if (isEditing) {\r\n      if (selectedItems.length === 0) {\r\n        confirmCancelEditing();\r\n      } else {\r\n        Alert.alert(\r\n          \"Предупреждение\",\r\n          \"Данные могут не сохраниться. Отменить редактирование?\",\r\n          [\r\n            { text: \"Нет\" },\r\n            { text: \"Да\", onPress: confirmCancelEditing }\r\n          ],\r\n          { cancelable: false }\r\n        );\r\n      }\r\n    } else {\r\n      navigation.goBack();\r\n    }\r\n  };\r\n\r\n  const confirmCancelEditing = () => {\r\n    setIsEditing(false);\r\n    setEditableItems({});\r\n    setSelectedItems([]);\r\n  };\r\n\r\n  return (\r\n    <SafeAreaView style={styles.container}>\r\n      <View style={styles.contentContainerTask}>\r\n        <View style={styles.taskHeader}>\r\n          <TouchableOpacity onPress={handleBackPress}>\r\n            <BackIcon />\r\n          </TouchableOpacity>\r\n          <Text style={[styles.titleMedium, { flex: 1, textAlign: 'center' }]}>Склад</Text>\r\n          {selectedItems.length === 0 ? (\r\n            <TouchableOpacity onPress={openHistoryModal}>\r\n              <DocumentIcon />\r\n            </TouchableOpacity>\r\n          ) : isEditing ? (\r\n            <TouchableOpacity onPress={() => handleDeleteItem(selectedItems[0])}>\r\n              <DeleteIcon />\r\n            </TouchableOpacity>\r\n          ) : (\r\n            <TouchableOpacity onPress={handleEditPress}>\r\n              <EditIcon />\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n        <TextInput\r\n          style={styles.searchInput}\r\n          placeholder=\"Поиск по складу\"\r\n          onChangeText={handleSearchChange}\r\n          value={searchQuery}\r\n        />\r\n        {isHistoryModalVisible && (\r\n          <ChangeHistoryModal\r\n            isVisible={isHistoryModalVisible}\r\n            onClose={() => setIsHistoryModalVisible(false)}\r\n          />\r\n        )}\r\n        <ScrollView horizontal overScrollMode=\"never\">\r\n          <SafeAreaView>\r\n            <FlatList\r\n              data={inventory}\r\n              keyExtractor={(item) => String(item.id)}\r\n              renderItem={renderRow}\r\n              ListHeaderComponent={\r\n                <View style={styles.headerTable}>\r\n                  <View style={styles.headercheckboxTableCell}>\r\n                    <TouchableOpacity\r\n                      style={styles.checkboxTable}\r\n                      onPress={handleSelectAllItems}\r\n                    >\r\n                      {selectedItems.length === inventory.length ? (\r\n                        <View style={styles.checkboxTableSelected} />\r\n                      ) : null}\r\n                    </TouchableOpacity>\r\n                  </View>\r\n                  <Text style={styles.headerCell}>Название</Text>\r\n                  <Text style={styles.headerCell}>Единица измерения</Text>\r\n                  <Text style={styles.headerCell}>Количество</Text>\r\n                </View>\r\n              }\r\n              ListFooterComponent={\r\n                <Pagination\r\n                  currentPage={currentPage}\r\n                  totalPages={totalPages}\r\n                  onPageChange={setCurrentPage}\r\n                />\r\n              }\r\n            />\r\n          </SafeAreaView>\r\n        </ScrollView>\r\n        <TouchableOpacity style={styles.addButton} onPress={handleButtonPress}>\r\n          <Text style={styles.addButtonText}>\r\n            {isEditing ? \"Применить изменения\" : \"Добавить предмет\"}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nexport default InventoryScreen;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}