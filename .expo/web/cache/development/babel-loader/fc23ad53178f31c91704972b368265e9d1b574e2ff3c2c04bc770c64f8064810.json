{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"serviceName\"];\nvar _jsxFileName = \"C:\\\\Users\\\\fred\\\\Desktop\\\\client\\\\src\\\\screens\\\\TaskDetailScreen.js\",\n  _this = this;\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useEffect, useCallback } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport styles from '../styles/styles';\nimport { formatDate, formatTime } from '../utils/dateFormatter';\nimport { updateTaskStatus } from '../utils/taskScreenHelpers';\nimport DropdownItem from '../components/DropdownItem';\nimport { fetchTaskParticipants, fetchDraftData } from '../utils/tasks';\nimport { BackIcon, EditIcon, None } from '../icons';\nimport NewTaskScreen from './NewTaskScreen';\nimport * as ImagePicker from 'expo-image-picker';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar TaskDetailScreen = function TaskDetailScreen(_ref) {\n  var route = _ref.route;\n  var navigation = useNavigation();\n  var _route$params$params = route.params.params;\n  _route$params$params = _route$params$params === void 0 ? {} : _route$params$params;\n  var serviceName = _route$params$params.serviceName,\n    initialTask = _objectWithoutProperties(_route$params$params, _excluded);\n  var _useState = useState(initialTask),\n    _useState2 = _slicedToArray(_useState, 2),\n    task = _useState2[0],\n    setTask = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isModalVisible = _useState4[0],\n    setModalVisible = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    selectedInventory = _useState6[0],\n    setSelectedInventory = _useState6[1];\n  var _useState7 = useState([]),\n    _useState8 = _slicedToArray(_useState7, 2),\n    inventoryItems = _useState8[0],\n    setInventoryItems = _useState8[1];\n  var _useState9 = useState([]),\n    _useState10 = _slicedToArray(_useState9, 2),\n    taskInventory = _useState10[0],\n    setTaskInventory = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    isNewTaskScreenVisible = _useState12[0],\n    setNewTaskScreenVisible = _useState12[1];\n  var _useState13 = useState(null),\n    _useState14 = _slicedToArray(_useState13, 2),\n    draftData = _useState14[0],\n    setDraftData = _useState14[1];\n  var _useState15 = useState([]),\n    _useState16 = _slicedToArray(_useState15, 2),\n    selectedImages = _useState16[0],\n    setSelectedImages = _useState16[1];\n  var _useState17 = useState(false),\n    _useState18 = _slicedToArray(_useState17, 2),\n    fullScreenImageModalVisible = _useState18[0],\n    setFullScreenImageModalVisible = _useState18[1];\n  var _useState19 = useState(null),\n    _useState20 = _slicedToArray(_useState19, 2),\n    currentImage = _useState20[0],\n    setCurrentImage = _useState20[1];\n  var _useState21 = useState(0),\n    _useState22 = _slicedToArray(_useState21, 2),\n    currentImageIndex = _useState22[0],\n    setCurrentImageIndex = _useState22[1];\n  var openFullScreenImage = function openFullScreenImage(index) {\n    setCurrentImageIndex(index);\n    setFullScreenImageModalVisible(true);\n  };\n  var showNextImage = function showNextImage() {\n    if (currentImageIndex < selectedImages.length - 1) {\n      setCurrentImageIndex(currentImageIndex + 1);\n    }\n  };\n  var showPreviousImage = function showPreviousImage() {\n    if (currentImageIndex > 0) {\n      setCurrentImageIndex(currentImageIndex - 1);\n    }\n  };\n  var FullScreenImageModal = function FullScreenImageModal(_ref2) {\n    var _selectedImages$curre;\n    var isVisible = _ref2.isVisible,\n      onClose = _ref2.onClose;\n    var imageUri = (_selectedImages$curre = selectedImages[currentImageIndex]) == null ? void 0 : _selectedImages$curre.uri;\n    return _jsxDEV(Modal, {\n      visible: isVisible,\n      transparent: false,\n      animationType: \"fade\",\n      onRequestClose: onClose,\n      children: _jsxDEV(View, {\n        style: {\n          flex: 1,\n          backgroundColor: 'black',\n          justifyContent: 'center',\n          alignItems: 'center'\n        },\n        children: [imageUri && _jsxDEV(Image, {\n          source: {\n            uri: imageUri\n          },\n          style: {\n            width: '100%',\n            height: '100%',\n            resizeMode: 'contain'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 13\n        }, _this), _jsxDEV(TouchableOpacity, {\n          style: {\n            position: 'absolute',\n            top: 40,\n            right: 20\n          },\n          onPress: onClose,\n          children: _jsxDEV(Text, {\n            style: {\n              color: 'white',\n              fontSize: 30\n            },\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, _this), currentImageIndex > 0 && _jsxDEV(TouchableOpacity, {\n          style: {\n            position: 'absolute',\n            left: 0,\n            top: 0,\n            bottom: 0,\n            right: '50%',\n            justifyContent: 'center'\n          },\n          onPress: showPreviousImage,\n          children: _jsxDEV(Text, {\n            style: {\n              color: 'white',\n              fontSize: 42,\n              textAlign: 'left',\n              marginLeft: 20\n            },\n            children: \"\\u2039\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 13\n        }, _this), currentImageIndex < selectedImages.length - 1 && _jsxDEV(TouchableOpacity, {\n          style: {\n            position: 'absolute',\n            right: 0,\n            top: 0,\n            bottom: 0,\n            left: '50%',\n            justifyContent: 'center'\n          },\n          onPress: showNextImage,\n          children: _jsxDEV(Text, {\n            style: {\n              color: 'white',\n              fontSize: 42,\n              textAlign: 'right',\n              marginRight: 20\n            },\n            children: \"\\u203A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, _this);\n  };\n  var handleChoosePhoto = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      var permissionResult = yield ImagePicker.requestMediaLibraryPermissionsAsync();\n      if (!permissionResult.granted) {\n        Alert.alert('Уведомление', 'Необходим доступ к фотографиям для загрузки в отчет');\n        return;\n      }\n      try {\n        var pickerResult = yield ImagePicker.launchImageLibraryAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.Images,\n          allowsMultipleSelection: true,\n          quality: 1\n        });\n        if (!pickerResult.canceled) {\n          setSelectedImages(function (prevImages) {\n            return [].concat(_toConsumableArray(prevImages), _toConsumableArray(pickerResult.assets || []));\n          });\n          console.log(selectedImages);\n        }\n      } catch (error) {\n        Alert.alert('Ошибка', 'Произошла ошибка при выборе фотографий');\n      }\n    });\n    return function handleChoosePhoto() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var uploadImages = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      if (selectedImages.length === 0) {\n        Alert.alert('Уведомление', 'Пожалуйста, выберите фотографии для загрузки');\n        return;\n      }\n      var formData = new FormData();\n      selectedImages.forEach(function (image, index) {\n        formData.append('photos', {\n          name: `photo_${index}.jpg`,\n          type: 'image/jpeg',\n          uri: Platform.OS === 'android' ? image.uri : image.uri.replace('file://', '')\n        });\n      });\n      try {\n        var taskId = task.id;\n        var response = yield fetch(`http://31.129.101.174/tasks/${taskId}/photos`, {\n          method: 'POST',\n          body: formData,\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        if (!response.ok) throw new Error('Сетевая ошибка при загрузке изображений');\n        setSelectedImages([]);\n      } catch (error) {\n        Alert.alert('Ошибка', 'Произошла ошибка при загрузке фотографий');\n      }\n    });\n    return function uploadImages() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var handleRemoveImage = function handleRemoveImage(index) {\n    setSelectedImages(function (currentImages) {\n      return currentImages.filter(function (_, i) {\n        return i !== index;\n      });\n    });\n  };\n  var handleCancelTaskPress = function handleCancelTaskPress() {\n    Alert.alert(\"Отмена задачи\", \"Вы уверены, что хотите отменить задачу?\", [{\n      text: \"Нет\",\n      style: \"cancel\"\n    }, {\n      text: \"Да\",\n      onPress: function onPress() {\n        return updateTaskStatusToCancelled();\n      }\n    }]);\n  };\n  var updateTaskStatusToCancelled = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      try {\n        var updatedTask = _objectSpread(_objectSpread({}, task), {}, {\n          status: 'отменено'\n        });\n        yield updateTaskStatus(task.id, updatedTask);\n        setTask(updatedTask);\n        if (isModalVisible) {\n          setModalVisible(false);\n        } else {\n          navigation.goBack();\n        }\n      } catch (error) {\n        console.error('Ошибка при обновлении статуса задачи:', error);\n      }\n    });\n    return function updateTaskStatusToCancelled() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var handleAddTaskPress = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      if (task.status === 'в процессе') {\n        setModalVisible(true);\n      } else {\n        try {\n          var updatedTask = _objectSpread(_objectSpread({}, task), {}, {\n            status: 'в процессе'\n          });\n          yield updateTaskStatus(task.id, updatedTask);\n          setTask(updatedTask);\n          navigation.navigate('Tabs', {\n            screen: 'TasksScreen'\n          });\n        } catch (error) {\n          console.error('Ошибка при обновлении статуса задачи:', error);\n        }\n      }\n    });\n    return function handleAddTaskPress() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var handleBackPress = function handleBackPress() {\n    navigation.goBack();\n  };\n  useEffect(function () {}, [task.id]);\n  useEffect(function () {\n    var fetchTaskInventory = function () {\n      var _ref7 = _asyncToGenerator(function* () {\n        if (task.status === 'выполнено') {\n          try {\n            var response = yield fetch(`http://31.129.101.174/tasks/${task.id}/inventory`);\n            var data = yield response.json();\n            setTaskInventory(data);\n          } catch (error) {\n            console.error('Ошибка при получении расходников для задачи:', error);\n          }\n        }\n      });\n      return function fetchTaskInventory() {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n    fetchTaskInventory();\n  }, [task.status, task.id]);\n  var ImagePreview = function ImagePreview(_ref8) {\n    var images = _ref8.images,\n      onRemovePress = _ref8.onRemovePress;\n    return _jsxDEV(ScrollView, {\n      horizontal: true,\n      style: styles.imagePreviewContainer,\n      showsHorizontalScrollIndicator: false,\n      children: [images.map(function (image, index) {\n        return _jsxDEV(View, {\n          style: styles.imageContainer,\n          children: _jsxDEV(TouchableOpacity, {\n            onPress: function onPress() {\n              return openFullScreenImage(index);\n            },\n            style: styles.imagePreview,\n            children: [_jsxDEV(Image, {\n              source: {\n                uri: image.uri\n              },\n              style: styles.image\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 13\n            }, _this), _jsxDEV(TouchableOpacity, {\n              style: styles.removeIconContainer,\n              onPress: function onPress() {\n                return onRemovePress(index);\n              },\n              children: _jsxDEV(Text, {\n                style: styles.removeIcon,\n                children: \"\\xD7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 222,\n                columnNumber: 15\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 13\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 11\n          }, _this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 9\n        }, _this);\n      }), _jsxDEV(TouchableOpacity, {\n        onPress: handleChoosePhoto,\n        style: styles.image,\n        children: _jsxDEV(View, {\n          style: styles.photoPickerContainer,\n          children: _jsxDEV(Text, {\n            style: styles.photoPickerPlusIcon,\n            children: \"+\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 11\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 9\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 7\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 5\n    }, _this);\n  };\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var data = yield fetchDraftData(task.id);\n      setDraftData(data);\n    })();\n  }, [task.id, task.status]);\n  var handleInventoryChange = function handleInventoryChange(newSelectedInventory) {\n    setSelectedInventory(newSelectedInventory);\n  };\n  var handleEditPress = function handleEditPress() {\n    if (draftData) {\n      setNewTaskScreenVisible(true);\n    } else {\n      navigation.navigate('TaskDetail', {\n        screen: 'TaskDetailScreen',\n        params: _objectSpread(_objectSpread({}, task), {}, {\n          serviceName: serviceName\n        })\n      });\n    }\n  };\n  var getHeaderTitle = function getHeaderTitle() {\n    switch (task.status) {\n      case 'новая':\n        return 'Новая задача';\n      case 'в процессе':\n        return 'Задача в процессе';\n      case 'выполнено':\n        return 'Завершенная задача';\n      default:\n        return 'Детали задачи';\n    }\n  };\n  var completeTask = function () {\n    var _ref10 = _asyncToGenerator(function* () {\n      if (selectedInventory.length === 0) {\n        alert('Выберите инвентарь перед завершением задачи.');\n        return;\n      }\n      try {\n        var updatedTask = _objectSpread(_objectSpread({}, task), {}, {\n          status: 'выполнено'\n        });\n        var statusResponse = yield updateTaskStatus(task.id, updatedTask);\n        var filteredInventory = selectedInventory.filter(function (item) {\n          return item.quantity > 0;\n        });\n        var inventoryResponse = yield fetch(`http://31.129.101.174/tasks/${task.id}/complete`, {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            inventory: filteredInventory.map(function (item) {\n              return {\n                inventory_id: item.id,\n                quantity: item.quantity\n              };\n            })\n          })\n        });\n        if (!inventoryResponse.ok) {\n          throw new Error('Ошибка при обновлении инвентаря');\n        }\n        var inventoryResult = yield inventoryResponse.json();\n        yield uploadImages();\n        setModalVisible(false);\n        navigation.navigate('Tabs', {\n          screen: 'TasksScreen'\n        });\n      } catch (error) {\n        console.error('Ошибка при завершении задачи:', error);\n      }\n    });\n    return function completeTask() {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n  var fetchInventoryItems = function () {\n    var _ref11 = _asyncToGenerator(function* () {\n      try {\n        var response = yield fetch('http://31.129.101.174/inventory');\n        var data = yield response.json();\n        setInventoryItems(data);\n      } catch (error) {\n        console.error('Ошибка при получении инвентаря:', error);\n      }\n    });\n    return function fetchInventoryItems() {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    fetchInventoryItems();\n  }, []);\n  useEffect(function () {\n    var updateTaskDetails = function () {\n      var _ref12 = _asyncToGenerator(function* () {\n        var participants = yield fetchTaskParticipants(task.id);\n        setTask(_objectSpread(_objectSpread({}, task), {}, {\n          employees: participants\n        }));\n      });\n      return function updateTaskDetails() {\n        return _ref12.apply(this, arguments);\n      };\n    }();\n    updateTaskDetails();\n  }, [task.id]);\n  var Section = function Section(_ref13) {\n    var title = _ref13.title,\n      children = _ref13.children;\n    return _jsxDEV(View, {\n      style: styles.section,\n      children: [_jsxDEV(Text, {\n        style: styles.sectionTitle,\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 7\n      }, _this), _jsxDEV(View, {\n        style: styles.sectionContent,\n        children: children\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 7\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 5\n    }, _this);\n  };\n  var Row = function Row(_ref14) {\n    var title = _ref14.title,\n      value = _ref14.value;\n    var displayValue = value;\n    if (Array.isArray(value) && value.length > 0 && value[0].hasOwnProperty('full_name')) {\n      displayValue = value.map(function (employee) {\n        return employee.full_name;\n      }).join(', ');\n    }\n    return _jsxDEV(View, {\n      style: styles.rowStyle,\n      children: [_jsxDEV(Text, {\n        style: styles.rowTitle,\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, _this), _jsxDEV(Text, {\n        style: styles.rowValue,\n        children: displayValue\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 7\n    }, _this);\n  };\n  return _jsxDEV(SafeAreaView, {\n    style: styles.container,\n    children: [_jsxDEV(View, {\n      style: styles.contentContainerTask,\n      children: [_jsxDEV(FullScreenImageModal, {\n        isVisible: fullScreenImageModalVisible,\n        imageUri: currentImage,\n        onClose: function onClose() {\n          return setFullScreenImageModalVisible(false);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }, _this), _jsxDEV(View, {\n        style: styles.taskHeader,\n        children: [_jsxDEV(TouchableOpacity, {\n          onPress: handleBackPress,\n          children: _jsxDEV(BackIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, _this), _jsxDEV(Text, {\n          style: [styles.titleMedium, {\n            flex: 1,\n            textAlign: 'center'\n          }],\n          children: getHeaderTitle()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 11\n        }, _this), task.status !== 'отменено' ? _jsxDEV(TouchableOpacity, {\n          onPress: handleEditPress,\n          children: _jsxDEV(EditIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 13\n        }, _this) : _jsxDEV(None, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, _this), _jsxDEV(ScrollView, {\n        contentContainerStyle: styles.scrollViewContent,\n        showsVerticalScrollIndicator: false,\n        overScrollMode: \"never\",\n        children: [_jsxDEV(Text, {\n          style: styles.headlineMedium,\n          children: serviceName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 11\n        }, _this), _jsxDEV(Section, {\n          title: \"\\u041A\\u043B\\u0438\\u0435\\u043D\\u0442\",\n          children: [_jsxDEV(Row, {\n            title: \"\\u0424\\u0418\\u041E:\",\n            value: task.fullname_client\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 13\n          }, _this), _jsxDEV(Row, {\n            title: \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\",\n            value: task.phone\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 13\n          }, _this), _jsxDEV(Row, {\n            title: \"\\u0410\\u0434\\u0440\\u0435\\u0441:\",\n            value: task.address_client\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 11\n        }, _this), _jsxDEV(Section, {\n          title: \"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0430\",\n          children: [_jsxDEV(Row, {\n            title: \"\\u0421\\u043F\\u043E\\u0441\\u043E\\u0431 \\u043E\\u043F\\u043B\\u0430\\u0442\\u044B:\",\n            value: task.payment || 'Не указан'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, _this), _jsxDEV(Row, {\n            title: \"\\u0421\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C:\",\n            value: task.cost ? `${task.cost} руб.` : 'Не указана'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, _this), _jsxDEV(Section, {\n          title: \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u0430\",\n          children: [_jsxDEV(Row, {\n            title: \"\\u041E\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0435\\u043D\\u043D\\u044B\\u0439:\",\n            value: task.responsible || 'Не назначен'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 13\n          }, _this), _jsxDEV(Row, {\n            title: \"\\u0423\\u0447\\u0430\\u0441\\u0442\\u043D\\u0438\\u043A\\u0438:\",\n            value: task.employees || 'Нет информации'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 13\n          }, _this), _jsxDEV(Row, {\n            title: \"\\u0414\\u0430\\u0442\\u0430 \\u0438 \\u0432\\u0440\\u0435\\u043C\\u044F \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430:\",\n            value: task.start_date ? `${formatDate(task.start_date)} ${formatTime(task.start_time)}` : 'Не указаны'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, _this), _jsxDEV(Row, {\n            title: \"\\u0414\\u0430\\u0442\\u0430 \\u0438 \\u0432\\u0440\\u0435\\u043C\\u044F \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F:\",\n            value: task.end_date ? `${formatDate(task.end_date)} ${formatTime(task.end_time)}` : 'Не указаны'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, _this), task.status === 'выполнено' && _jsxDEV(Section, {\n          title: \"\\u0420\\u0430\\u0441\\u0445\\u043E\\u0434\\u043D\\u0438\\u043A\\u0438\",\n          children: taskInventory.length > 0 ? taskInventory.map(function (item, index) {\n            return _jsxDEV(Row, {\n              title: item.name,\n              value: `Количество: ${item.quantity}`\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 19\n            }, _this);\n          }) : _jsxDEV(Text, {\n            style: styles.bodyMedium,\n            children: \"\\u0420\\u0430\\u0441\\u0445\\u043E\\u0434\\u043D\\u0438\\u043A\\u0438 \\u043D\\u0435 \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u043B\\u0438\\u0441\\u044C.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 17\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 13\n        }, _this), _jsxDEV(Section, {\n          title: \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435\",\n          children: _jsxDEV(Text, {\n            style: [styles.bodyMedium, {\n              marginBottom: 300\n            }],\n            children: task.description || 'Описание отсутствует.'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, _this), _jsxDEV(Modal, {\n        visible: isModalVisible,\n        animationType: \"slide\",\n        onRequestClose: function onRequestClose() {\n          return setModalVisible(false);\n        },\n        children: _jsxDEV(SafeAreaView, {\n          style: styles.container,\n          children: _jsxDEV(View, {\n            style: styles.contentContainerTask,\n            children: [_jsxDEV(View, {\n              style: styles.taskHeader,\n              children: [_jsxDEV(TouchableOpacity, {\n                onPress: function onPress() {\n                  return setModalVisible(false);\n                },\n                children: _jsxDEV(BackIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 434,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 433,\n                columnNumber: 17\n              }, _this), _jsxDEV(Text, {\n                style: [styles.titleMedium, {\n                  flex: 1,\n                  textAlign: 'center'\n                }],\n                children: \" \\u041E\\u0442\\u0447\\u0451\\u0442 \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 17\n              }, _this), _jsxDEV(TouchableOpacity, {\n                children: _jsxDEV(None, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 438,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 437,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 15\n            }, _this), _jsxDEV(View, {\n              style: styles.contentContainer,\n              children: [_jsxDEV(DropdownItem, {\n                label: \"\\u0420\\u0430\\u0441\\u0445\\u043E\\u0434\\u043D\\u0438\\u043A\\u0438\",\n                options: inventoryItems,\n                selectedValues: selectedInventory,\n                onValueChange: handleInventoryChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 442,\n                columnNumber: 17\n              }, _this), _jsxDEV(ImagePreview, {\n                images: selectedImages,\n                onAddPress: handleChoosePhoto,\n                onRemovePress: handleRemoveImage\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 448,\n                columnNumber: 17\n              }, _this), _jsxDEV(TouchableOpacity, {\n                onPress: uploadImages,\n                children: _jsxDEV(Text, {\n                  children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0438\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 454,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 17\n              }, _this), _jsxDEV(TouchableOpacity, {\n                style: styles.addButton,\n                onPress: completeTask,\n                children: _jsxDEV(Text, {\n                  style: styles.addButtonText,\n                  children: \"\\u0417\\u0430\\u0432\\u0435\\u0440\\u0448\\u0438\\u0442\\u044C \\u0440\\u0430\\u0431\\u043E\\u0442\\u0443\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 457,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 441,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 9\n      }, _this), task.status !== 'выполнено' && task.status !== 'отменено' && _jsxDEV(_Fragment, {\n        children: [_jsxDEV(TouchableOpacity, {\n          style: [styles.addButton, {\n            marginBottom: 68\n          }],\n          onPress: handleAddTaskPress,\n          children: _jsxDEV(Text, {\n            style: styles.addButtonText,\n            children: task.status === 'в процессе' ? 'Добавить расходники' : 'Начать выполнение'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 466,\n          columnNumber: 11\n        }, _this), _jsxDEV(TouchableOpacity, {\n          style: [styles.addButton, {\n            backgroundColor: 'black'\n          }],\n          onPress: handleCancelTaskPress,\n          children: _jsxDEV(Text, {\n            style: styles.addButtonText,\n            children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430\\u0434\\u0430\\u0447\\u0443\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 7\n    }, _this), _jsxDEV(Modal, {\n      visible: isNewTaskScreenVisible,\n      animationType: \"slide\",\n      onRequestClose: function onRequestClose() {\n        return setNewTaskScreenVisible(false);\n      },\n      children: _jsxDEV(NewTaskScreen, {\n        onClose: function onClose() {\n          return setNewTaskScreenVisible(false);\n        },\n        draftData: draftData\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 365,\n    columnNumber: 5\n  }, _this);\n};\nexport default TaskDetailScreen;","map":{"version":3,"names":["React","useState","useEffect","useCallback","View","Text","TouchableOpacity","ScrollView","Modal","Platform","Alert","Image","SafeAreaView","useNavigation","styles","formatDate","formatTime","updateTaskStatus","DropdownItem","fetchTaskParticipants","fetchDraftData","BackIcon","EditIcon","None","NewTaskScreen","ImagePicker","jsxDEV","_jsxDEV","Fragment","_Fragment","TaskDetailScreen","_ref","route","navigation","_route$params$params","params","serviceName","initialTask","_objectWithoutProperties","_excluded","_useState","_useState2","_slicedToArray","task","setTask","_useState3","_useState4","isModalVisible","setModalVisible","_useState5","_useState6","selectedInventory","setSelectedInventory","_useState7","_useState8","inventoryItems","setInventoryItems","_useState9","_useState10","taskInventory","setTaskInventory","_useState11","_useState12","isNewTaskScreenVisible","setNewTaskScreenVisible","_useState13","_useState14","draftData","setDraftData","_useState15","_useState16","selectedImages","setSelectedImages","_useState17","_useState18","fullScreenImageModalVisible","setFullScreenImageModalVisible","_useState19","_useState20","currentImage","setCurrentImage","_useState21","_useState22","currentImageIndex","setCurrentImageIndex","openFullScreenImage","index","showNextImage","length","showPreviousImage","FullScreenImageModal","_ref2","_selectedImages$curre","isVisible","onClose","imageUri","uri","visible","transparent","animationType","onRequestClose","children","style","flex","backgroundColor","justifyContent","alignItems","source","width","height","resizeMode","fileName","_jsxFileName","lineNumber","columnNumber","_this","position","top","right","onPress","color","fontSize","left","bottom","textAlign","marginLeft","marginRight","handleChoosePhoto","_ref3","_asyncToGenerator","permissionResult","requestMediaLibraryPermissionsAsync","granted","alert","pickerResult","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsMultipleSelection","quality","canceled","prevImages","concat","_toConsumableArray","assets","console","log","error","apply","arguments","uploadImages","_ref4","formData","FormData","forEach","image","append","name","type","OS","replace","taskId","id","response","fetch","method","body","headers","ok","Error","handleRemoveImage","currentImages","filter","_","i","handleCancelTaskPress","text","updateTaskStatusToCancelled","_ref5","updatedTask","_objectSpread","status","goBack","handleAddTaskPress","_ref6","navigate","screen","handleBackPress","fetchTaskInventory","_ref7","data","json","ImagePreview","_ref8","images","onRemovePress","horizontal","imagePreviewContainer","showsHorizontalScrollIndicator","map","imageContainer","imagePreview","removeIconContainer","removeIcon","photoPickerContainer","photoPickerPlusIcon","handleInventoryChange","newSelectedInventory","handleEditPress","getHeaderTitle","completeTask","_ref10","statusResponse","filteredInventory","item","quantity","inventoryResponse","JSON","stringify","inventory","inventory_id","inventoryResult","fetchInventoryItems","_ref11","updateTaskDetails","_ref12","participants","employees","Section","_ref13","title","section","sectionTitle","sectionContent","Row","_ref14","value","displayValue","Array","isArray","hasOwnProperty","employee","full_name","join","rowStyle","rowTitle","rowValue","container","contentContainerTask","taskHeader","titleMedium","contentContainerStyle","scrollViewContent","showsVerticalScrollIndicator","overScrollMode","headlineMedium","fullname_client","phone","address_client","payment","cost","responsible","start_date","start_time","end_date","end_time","bodyMedium","marginBottom","description","contentContainer","label","options","selectedValues","onValueChange","onAddPress","addButton","addButtonText"],"sources":["C:/Users/fred/Desktop/client/src/screens/TaskDetailScreen.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { View, Text, TouchableOpacity, ScrollView, Modal, Platform, Alert, Image } from 'react-native';\r\nimport { SafeAreaView } from 'react-native-safe-area-context';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport styles from '../styles/styles';\r\nimport { formatDate, formatTime } from '../utils/dateFormatter';\r\nimport { updateTaskStatus } from '../utils/taskScreenHelpers';\r\nimport DropdownItem from '../components/DropdownItem';\r\nimport { fetchTaskParticipants, fetchDraftData } from '../utils/tasks';\r\nimport { BackIcon, EditIcon, None } from '../icons';\r\nimport NewTaskScreen from './NewTaskScreen';\r\nimport * as ImagePicker from 'expo-image-picker';\r\n\r\nconst TaskDetailScreen = ({ route }) => {\r\n  const navigation = useNavigation();\r\n  const { params: { serviceName, ...initialTask } = {} } = route.params;\r\n  const [task, setTask] = useState(initialTask);\r\n  const [isModalVisible, setModalVisible] = useState(false);\r\n  const [selectedInventory, setSelectedInventory] = useState([]);\r\n  const [inventoryItems, setInventoryItems] = useState([]);\r\n  const [taskInventory, setTaskInventory] = useState([]);\r\n  const [isNewTaskScreenVisible, setNewTaskScreenVisible] = useState(false);\r\n  const [draftData, setDraftData] = useState(null);\r\n  const [selectedImages, setSelectedImages] = useState([]);\r\n  const [fullScreenImageModalVisible, setFullScreenImageModalVisible] = useState(false);\r\n  const [currentImage, setCurrentImage] = useState(null);\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\r\n\r\n  const openFullScreenImage = (index) => {\r\n    setCurrentImageIndex(index);\r\n    setFullScreenImageModalVisible(true);\r\n  };\r\n\r\n  const showNextImage = () => {\r\n    if (currentImageIndex < selectedImages.length - 1) {\r\n      setCurrentImageIndex(currentImageIndex + 1);\r\n    }\r\n  };\r\n\r\n  const showPreviousImage = () => {\r\n    if (currentImageIndex > 0) {\r\n      setCurrentImageIndex(currentImageIndex - 1);\r\n    }\r\n  };\r\n\r\n  const FullScreenImageModal = ({ isVisible, onClose }) => {\r\n    const imageUri = selectedImages[currentImageIndex]?.uri;\r\n\r\n    return (\r\n      <Modal\r\n        visible={isVisible}\r\n        transparent={false}\r\n        animationType=\"fade\"\r\n        onRequestClose={onClose}\r\n      >\r\n        <View style={{ flex: 1, backgroundColor: 'black', justifyContent: 'center', alignItems: 'center' }}>\r\n          {imageUri && (\r\n            <Image\r\n              source={{ uri: imageUri }}\r\n              style={{ width: '100%', height: '100%', resizeMode: 'contain' }}\r\n            />\r\n          )}\r\n          <TouchableOpacity style={{ position: 'absolute', top: 40, right: 20 }} onPress={onClose}>\r\n            <Text style={{ color: 'white', fontSize: 30 }}>×</Text>\r\n          </TouchableOpacity>\r\n\r\n          {currentImageIndex > 0 && (\r\n            <TouchableOpacity\r\n              style={{ position: 'absolute', left: 0, top: 0, bottom: 0, right: '50%', justifyContent: 'center' }}\r\n              onPress={showPreviousImage}\r\n            >\r\n              <Text style={{ color: 'white', fontSize: 42, textAlign: 'left', marginLeft: 20 }}>‹</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n\r\n          {currentImageIndex < selectedImages.length - 1 && (\r\n            <TouchableOpacity\r\n              style={{ position: 'absolute', right: 0, top: 0, bottom: 0, left: '50%', justifyContent: 'center' }}\r\n              onPress={showNextImage}\r\n            >\r\n              <Text style={{ color: 'white', fontSize: 42, textAlign: 'right', marginRight: 20 }}>›</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n      </Modal>\r\n    );\r\n  };\r\n\r\n  const handleChoosePhoto = async () => {\r\n    const permissionResult = await ImagePicker.requestMediaLibraryPermissionsAsync();\r\n    if (!permissionResult.granted) {\r\n      Alert.alert('Уведомление', 'Необходим доступ к фотографиям для загрузки в отчет');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const pickerResult = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsMultipleSelection: true,\r\n        quality: 1,\r\n      });\r\n\r\n      if (!pickerResult.canceled) {\r\n        setSelectedImages(prevImages => [...prevImages, ...(pickerResult.assets || [])]);\r\n        console.log(selectedImages);\r\n      }\r\n    } catch (error) {\r\n      Alert.alert('Ошибка', 'Произошла ошибка при выборе фотографий');\r\n    }\r\n  };\r\n\r\n  const uploadImages = async () => {\r\n    if (selectedImages.length === 0) {\r\n      Alert.alert('Уведомление', 'Пожалуйста, выберите фотографии для загрузки');\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    selectedImages.forEach((image, index) => {\r\n      formData.append('photos', {\r\n        name: `photo_${index}.jpg`,\r\n        type: 'image/jpeg', // Используем стандартный MIME-тип для JPEG\r\n        uri: Platform.OS === 'android' ? image.uri : image.uri.replace('file://', ''),\r\n      });\r\n    });\r\n\r\n    try {\r\n      // Предполагаем, что taskId доступен в текущем состоянии\r\n      const taskId = task.id; // или получить его из другого источника в зависимости от структуры приложения\r\n\r\n      const response = await fetch(`http://31.129.101.174/tasks/${taskId}/photos`, {\r\n        method: 'POST',\r\n        body: formData,\r\n        headers: { 'Content-Type': 'multipart/form-data' },\r\n      });\r\n\r\n      if (!response.ok) throw new Error('Сетевая ошибка при загрузке изображений');\r\n\r\n      setSelectedImages([]);\r\n    } catch (error) {\r\n      Alert.alert('Ошибка', 'Произошла ошибка при загрузке фотографий');\r\n    }\r\n  };\r\n\r\n  const handleRemoveImage = (index) => {\r\n    setSelectedImages(currentImages => currentImages.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleCancelTaskPress = () => {\r\n    Alert.alert(\r\n      \"Отмена задачи\",\r\n      \"Вы уверены, что хотите отменить задачу?\",\r\n      [\r\n        { text: \"Нет\", style: \"cancel\" },\r\n        { text: \"Да\", onPress: () => updateTaskStatusToCancelled() }\r\n      ]\r\n    );\r\n  };\r\n\r\n  const updateTaskStatusToCancelled = async () => {\r\n    try {\r\n      const updatedTask = { ...task, status: 'отменено' };\r\n      await updateTaskStatus(task.id, updatedTask);\r\n      setTask(updatedTask);\r\n      // После успешного обновления статуса, закрываем текущий экран или модальное окно\r\n      if (isModalVisible) {\r\n        setModalVisible(false);\r\n      } else {\r\n        navigation.goBack();\r\n      }\r\n    } catch (error) {\r\n      console.error('Ошибка при обновлении статуса задачи:', error);\r\n    }\r\n  };\r\n\r\n  const handleAddTaskPress = async () => {\r\n    if (task.status === 'в процессе') {\r\n      setModalVisible(true);\r\n    } else {\r\n      try {\r\n        const updatedTask = { ...task, status: 'в процессе' };\r\n        await updateTaskStatus(task.id, updatedTask); // Отправляем полный объект задачи\r\n        setTask(updatedTask); // Обновляем состояние задачи\r\n        navigation.navigate('Tabs', { screen: 'TasksScreen' });\r\n      } catch (error) {\r\n        console.error('Ошибка при обновлении статуса задачи:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleBackPress = () => {\r\n    navigation.goBack(); // Это вызовет возврат к предыдущему экрану в стеке навигации\r\n  };\r\n\r\n  useEffect(() => {\r\n  }, [task.id]);\r\n\r\n  useEffect(() => {\r\n    const fetchTaskInventory = async () => {\r\n      if (task.status === 'выполнено') {\r\n        try {\r\n          // Предполагается, что у тебя есть эндпойнт для получения инвентаря конкретной задачи\r\n          const response = await fetch(`http://31.129.101.174/tasks/${task.id}/inventory`);\r\n          const data = await response.json();\r\n          setTaskInventory(data);\r\n        } catch (error) {\r\n          console.error('Ошибка при получении расходников для задачи:', error);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchTaskInventory();\r\n  }, [task.status, task.id]);\r\n\r\n  const ImagePreview = ({ images, onRemovePress }) => (\r\n    <ScrollView horizontal style={styles.imagePreviewContainer} showsHorizontalScrollIndicator={false}>\r\n      {images.map((image, index) => (\r\n        <View key={index} style={styles.imageContainer}>\r\n          <TouchableOpacity onPress={() => openFullScreenImage(index)} style={styles.imagePreview}>\r\n            <Image source={{ uri: image.uri }} style={styles.image} />\r\n            <TouchableOpacity style={styles.removeIconContainer} onPress={() => onRemovePress(index)}>\r\n              <Text style={styles.removeIcon}>×</Text>\r\n            </TouchableOpacity>\r\n          </TouchableOpacity>\r\n        </View>\r\n      ))}\r\n      <TouchableOpacity onPress={handleChoosePhoto} style={styles.image}>\r\n        <View style={styles.photoPickerContainer}>\r\n          <Text style={styles.photoPickerPlusIcon}>+</Text>\r\n        </View>\r\n      </TouchableOpacity>\r\n    </ScrollView>\r\n  );\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const data = await fetchDraftData(task.id);\r\n      setDraftData(data);\r\n    })();\r\n  }, [task.id, task.status]);\r\n\r\n  const handleInventoryChange = (newSelectedInventory) => {\r\n    setSelectedInventory(newSelectedInventory);\r\n  };\r\n\r\n  const handleEditPress = () => {\r\n    if (draftData) {\r\n      setNewTaskScreenVisible(true);\r\n    } else {\r\n      navigation.navigate('TaskDetail', {\r\n        screen: 'TaskDetailScreen',\r\n        params: { ...task, serviceName },\r\n      });\r\n    }\r\n  };\r\n\r\n  const getHeaderTitle = () => {\r\n    switch (task.status) {\r\n      case 'новая':\r\n        return 'Новая задача';\r\n      case 'в процессе':\r\n        return 'Задача в процессе';\r\n      case 'выполнено':\r\n        return 'Завершенная задача';\r\n      default:\r\n        return 'Детали задачи'; // Для случая, если статус неизвестен\r\n    }\r\n  };\r\n\r\n  const completeTask = async () => {\r\n    // Проверяем, что выбран хотя бы один инвентарь\r\n    if (selectedInventory.length === 0) {\r\n      alert('Выберите инвентарь перед завершением задачи.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Обновляем статус задачи\r\n      const updatedTask = { ...task, status: 'выполнено' };\r\n      const statusResponse = await updateTaskStatus(task.id, updatedTask);\r\n\r\n      // Фильтруем выбранный инвентарь, исключая элементы с количеством ноль\r\n      const filteredInventory = selectedInventory.filter(item => item.quantity > 0);\r\n\r\n      // Отправляем данные о выбранном инвентаре на сервер\r\n      const inventoryResponse = await fetch(`http://31.129.101.174/tasks/${task.id}/complete`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          inventory: filteredInventory.map(item => ({\r\n            inventory_id: item.id,\r\n            quantity: item.quantity\r\n          })),\r\n        }),\r\n      });\r\n\r\n      if (!inventoryResponse.ok) {\r\n        throw new Error('Ошибка при обновлении инвентаря');\r\n      }\r\n\r\n      // Получаем ответ от сервера\r\n      const inventoryResult = await inventoryResponse.json();\r\n      await uploadImages();\r\n\r\n      // Закрыть модальное окно и перейти к списку задач\r\n      setModalVisible(false);\r\n      navigation.navigate('Tabs', { screen: 'TasksScreen' });\r\n    } catch (error) {\r\n      console.error('Ошибка при завершении задачи:', error);\r\n    }\r\n  };\r\n\r\n  const fetchInventoryItems = async () => {\r\n    try {\r\n      const response = await fetch('http://31.129.101.174/inventory');\r\n      const data = await response.json();\r\n      setInventoryItems(data);\r\n    } catch (error) {\r\n      console.error('Ошибка при получении инвентаря:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchInventoryItems();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Функция для обновления информации о задаче, включая участников\r\n    const updateTaskDetails = async () => {\r\n      const participants = await fetchTaskParticipants(task.id);\r\n      setTask({ ...task, employees: participants });\r\n    };\r\n\r\n    updateTaskDetails();\r\n  }, [task.id]);\r\n\r\n  const Section = ({ title, children }) => (\r\n    <View style={styles.section}>\r\n      <Text style={styles.sectionTitle}>{title}</Text>\r\n      <View style={styles.sectionContent}>\r\n        {children}\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  const Row = ({ title, value }) => {\r\n    let displayValue = value;\r\n\r\n    // Проверяем, является ли value массивом и содержит ли он объекты с полем full_name\r\n    if (Array.isArray(value) && value.length > 0 && value[0].hasOwnProperty('full_name')) {\r\n      displayValue = value.map(employee => employee.full_name).join(', ');\r\n    }\r\n\r\n    return (\r\n      <View style={styles.rowStyle}>\r\n        <Text style={styles.rowTitle}>{title}</Text>\r\n        <Text style={styles.rowValue}>{displayValue}</Text>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <SafeAreaView style={styles.container}>\r\n      <View style={styles.contentContainerTask}>\r\n        <FullScreenImageModal\r\n          isVisible={fullScreenImageModalVisible}\r\n          imageUri={currentImage}\r\n          onClose={() => setFullScreenImageModalVisible(false)}\r\n        />\r\n        <View style={styles.taskHeader}>\r\n          <TouchableOpacity onPress={handleBackPress}>\r\n            <BackIcon />\r\n          </TouchableOpacity>\r\n          <Text style={[styles.titleMedium, { flex: 1, textAlign: 'center' }]}>\r\n            {getHeaderTitle()}\r\n          </Text>\r\n          {task.status !== 'отменено' ? (\r\n            <TouchableOpacity onPress={handleEditPress}>\r\n              <EditIcon />\r\n            </TouchableOpacity>\r\n          ) : (\r\n            <None />\r\n          )}\r\n        </View>\r\n        <ScrollView contentContainerStyle={styles.scrollViewContent} showsVerticalScrollIndicator={false} overScrollMode=\"never\">\r\n          <Text style={styles.headlineMedium}>{serviceName}</Text>\r\n\r\n          <Section title=\"Клиент\">\r\n            <Row title=\"ФИО:\" value={task.fullname_client} />\r\n            <Row title=\"Телефон:\" value={task.phone} />\r\n            <Row title=\"Адрес:\" value={task.address_client} />\r\n          </Section>\r\n\r\n          <Section title=\"Оплата\">\r\n            <Row title=\"Способ оплаты:\" value={task.payment || 'Не указан'} />\r\n            <Row title=\"Стоимость:\" value={task.cost ? `${task.cost} руб.` : 'Не указана'} />\r\n          </Section>\r\n\r\n          <Section title=\"Работа\">\r\n            <Row title=\"Ответственный:\" value={task.responsible || 'Не назначен'} />\r\n            <Row title=\"Участники:\" value={task.employees || 'Нет информации'} />\r\n            <Row title=\"Дата и время начала:\" value={task.start_date ? `${formatDate(task.start_date)} ${formatTime(task.start_time)}` : 'Не указаны'} />\r\n            <Row title=\"Дата и время окончания:\" value={task.end_date ? `${formatDate(task.end_date)} ${formatTime(task.end_time)}` : 'Не указаны'} />\r\n          </Section>\r\n\r\n          {task.status === 'выполнено' && (\r\n            <Section title=\"Расходники\">\r\n              {taskInventory.length > 0 ? (\r\n                taskInventory.map((item, index) => (\r\n                  <Row key={index} title={item.name} value={`Количество: ${item.quantity}`} />\r\n                ))\r\n              ) : (\r\n                <Text style={styles.bodyMedium}>Расходники не использовались.</Text>\r\n              )}\r\n            </Section>\r\n          )}\r\n\r\n          <Section title=\"Описание\">\r\n            <Text style={[styles.bodyMedium, { marginBottom: 300 }]}>{task.description || 'Описание отсутствует.'}</Text>\r\n          </Section>\r\n        </ScrollView>\r\n\r\n        <Modal\r\n          visible={isModalVisible}\r\n          animationType=\"slide\"\r\n          onRequestClose={() => setModalVisible(false)}\r\n        >\r\n          <SafeAreaView style={styles.container}>\r\n            <View style={styles.contentContainerTask}>\r\n              <View style={styles.taskHeader}>\r\n                <TouchableOpacity onPress={() => setModalVisible(false)}>\r\n                  <BackIcon />\r\n                </TouchableOpacity>\r\n                <Text style={[styles.titleMedium, { flex: 1, textAlign: 'center' }]}> Отчёт </Text>\r\n                <TouchableOpacity>\r\n                  <None />\r\n                </TouchableOpacity>\r\n              </View>\r\n              <View style={styles.contentContainer}>\r\n                <DropdownItem\r\n                  label=\"Расходники\"\r\n                  options={inventoryItems}\r\n                  selectedValues={selectedInventory}\r\n                  onValueChange={handleInventoryChange}\r\n                />\r\n                <ImagePreview\r\n                  images={selectedImages}\r\n                  onAddPress={handleChoosePhoto}\r\n                  onRemovePress={handleRemoveImage}\r\n                />\r\n                <TouchableOpacity onPress={uploadImages}>\r\n                  <Text>Загрузить фотографии</Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity style={styles.addButton} onPress={completeTask}>\r\n                  <Text style={styles.addButtonText}>Завершить работу</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          </SafeAreaView>\r\n        </Modal>\r\n\r\n        {task.status !== 'выполнено' && task.status !== 'отменено' && (\r\n          <>\r\n          <TouchableOpacity style={[styles.addButton, { marginBottom: 68 }]} onPress={handleAddTaskPress}>\r\n            <Text style={styles.addButtonText}>\r\n              {task.status === 'в процессе' ? 'Добавить расходники' : 'Начать выполнение'}\r\n            </Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity style={[styles.addButton, { backgroundColor: 'black' }]} onPress={handleCancelTaskPress}>\r\n            <Text style={styles.addButtonText}>Отменить задачу</Text>\r\n          </TouchableOpacity>\r\n        </>\r\n        )}\r\n      </View>\r\n      <Modal\r\n        visible={isNewTaskScreenVisible}\r\n        animationType=\"slide\"\r\n        onRequestClose={() => setNewTaskScreenVisible(false)}\r\n      >\r\n        <NewTaskScreen onClose={() => setNewTaskScreenVisible(false)} draftData={draftData} />\r\n      </Modal>\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nexport default TaskDetailScreen;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}