{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useRef, useLayoutEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport { format, addMonths, startOfMonth, parseISO } from 'date-fns';\nimport { ru } from 'date-fns/locale';\nimport styles from \"../styles/styles\";\nimport RenderMonth from \"./RenderMonth\";\nimport TasksForSelectedDateComponent from \"./TasksForSelectedDateComponent\";\nimport PropTypes from 'prop-types';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar VerticalCalendar = function VerticalCalendar(_ref) {\n  var tasks = _ref.tasks,\n    taskDates = _ref.taskDates,\n    renderAddButton = _ref.renderAddButton;\n  var flatListRef = useRef(null);\n  var _useState = useState(new Date()),\n    _useState2 = _slicedToArray(_useState, 2),\n    selectedDate = _useState2[0],\n    setSelectedDate = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    modalVisible = _useState4[0],\n    setModalVisible = _useState4[1];\n  var _useState5 = useState(new Set()),\n    _useState6 = _slicedToArray(_useState5, 2),\n    expandedClients = _useState6[0],\n    setExpandedClients = _useState6[1];\n  var data = Array.from({\n    length: 5\n  }, function (_, i) {\n    return addMonths(startOfMonth(new Date()), i - 2);\n  });\n  var tasksBySelectedDate = tasks.filter(function (task) {\n    return format(parseISO(task.start_date), 'yyyy-MM-dd') === format(selectedDate, 'yyyy-MM-dd');\n  }).reduce(function (acc, task) {\n    return (acc[task.fullname_client] = acc[task.fullname_client] || []).push(task), acc;\n  }, {});\n  useLayoutEffect(function () {\n    var _flatListRef$current;\n    (_flatListRef$current = flatListRef.current) == null ? void 0 : _flatListRef$current.scrollToIndex({\n      index: 2,\n      animated: false\n    });\n  }, []);\n  var handleDatePress = function handleDatePress(day) {\n    setSelectedDate(day);\n    setModalVisible(true);\n  };\n  var handleToggleClient = function handleToggleClient(client) {\n    setExpandedClients(function (current) {\n      return new Set(current.has(client) ? current.delete(client) : current.add(client));\n    });\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsx(FlatList, {\n      ref: flatListRef,\n      data: data,\n      renderItem: function renderItem(_ref2) {\n        var item = _ref2.item;\n        return _jsx(RenderMonth, {\n          date: item,\n          handleDatePress: handleDatePress,\n          taskDates: taskDates\n        });\n      },\n      keyExtractor: function keyExtractor(item, index) {\n        return `${format(item, 'yyyy-MM')}-${index}`;\n      },\n      getItemLayout: function getItemLayout(_, index) {\n        return {\n          length: 400,\n          offset: 400 * index,\n          index: index\n        };\n      },\n      initialNumToRender: 5,\n      maxToRenderPerBatch: 5,\n      windowSize: 5,\n      onEndReachedThreshold: 0.5,\n      showsVerticalScrollIndicator: false,\n      removeClippedSubviews: true,\n      initialScrollIndex: 2\n    }), _jsx(Modal, {\n      animationType: \"slide\",\n      transparent: true,\n      visible: modalVisible,\n      children: _jsx(View, {\n        style: styles.container,\n        children: _jsxs(ScrollView, {\n          showsVerticalScrollIndicator: false,\n          style: styles.modalScrollView,\n          children: [_jsx(Text, {\n            style: styles.modalText,\n            children: format(selectedDate, 'd-MMMM', {\n              locale: ru\n            })\n          }), _jsx(TasksForSelectedDateComponent, {\n            tasksByClient: tasksBySelectedDate,\n            expandedClients: expandedClients,\n            toggleClient: handleToggleClient\n          })]\n        })\n      })\n    })]\n  });\n};\nVerticalCalendar.propTypes = {\n  tasks: PropTypes.array.isRequired,\n  taskDates: PropTypes.object.isRequired,\n  renderAddButton: PropTypes.func.isRequired\n};\nexport default VerticalCalendar;","map":{"version":3,"names":["React","useState","useRef","useLayoutEffect","View","Text","FlatList","Modal","ScrollView","format","addMonths","startOfMonth","parseISO","ru","styles","RenderMonth","TasksForSelectedDateComponent","PropTypes","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","VerticalCalendar","_ref","tasks","taskDates","renderAddButton","flatListRef","_useState","Date","_useState2","_slicedToArray","selectedDate","setSelectedDate","_useState3","_useState4","modalVisible","setModalVisible","_useState5","Set","_useState6","expandedClients","setExpandedClients","data","Array","from","length","_","i","tasksBySelectedDate","filter","task","start_date","reduce","acc","fullname_client","push","_flatListRef$current","current","scrollToIndex","index","animated","handleDatePress","day","handleToggleClient","client","has","delete","add","children","ref","renderItem","_ref2","item","date","keyExtractor","getItemLayout","offset","initialNumToRender","maxToRenderPerBatch","windowSize","onEndReachedThreshold","showsVerticalScrollIndicator","removeClippedSubviews","initialScrollIndex","animationType","transparent","visible","style","container","modalScrollView","modalText","locale","tasksByClient","toggleClient","propTypes","array","isRequired","object","func"],"sources":["C:/Users/fred/Desktop/client/src/components/VerticalCalendar.js"],"sourcesContent":["import React, { useState, useRef, useLayoutEffect } from 'react';\r\nimport { View, Text, FlatList, Modal, ScrollView } from 'react-native';\r\nimport { format, addMonths, startOfMonth, parseISO } from 'date-fns';\r\nimport { ru } from 'date-fns/locale';\r\nimport styles from '../styles/styles';\r\nimport RenderMonth from './RenderMonth';\r\nimport TasksForSelectedDateComponent from './TasksForSelectedDateComponent';\r\nimport PropTypes from 'prop-types';\r\n\r\nconst VerticalCalendar = ({ tasks, taskDates, renderAddButton }) => {\r\n  const flatListRef = useRef(null);\r\n  const [selectedDate, setSelectedDate] = useState(new Date());\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [expandedClients, setExpandedClients] = useState(new Set());\r\n\r\n  const data = Array.from({ length: 5 }, (_, i) => addMonths(startOfMonth(new Date()), i - 2));\r\n  const tasksBySelectedDate = tasks.filter(task => format(parseISO(task.start_date), 'yyyy-MM-dd') === format(selectedDate, 'yyyy-MM-dd'))\r\n    .reduce((acc, task) => ((acc[task.fullname_client] = acc[task.fullname_client] || []).push(task), acc), {});\r\n\r\n  useLayoutEffect(() => {\r\n    flatListRef.current?.scrollToIndex({ index: 2, animated: false });\r\n  }, []);\r\n\r\n  const handleDatePress = day => {\r\n    setSelectedDate(day);\r\n    setModalVisible(true);\r\n  };\r\n\r\n  const handleToggleClient = client => {\r\n    setExpandedClients(current => new Set(current.has(client) ? current.delete(client) : current.add(client)));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <FlatList\r\n        ref={flatListRef}\r\n        data={data}\r\n        renderItem={({ item }) => <RenderMonth date={item} handleDatePress={handleDatePress} taskDates={taskDates} />}\r\n        keyExtractor={(item, index) => `${format(item, 'yyyy-MM')}-${index}`}\r\n        getItemLayout={(_, index) => ({ length: 400, offset: 400 * index, index })}\r\n        initialNumToRender={5}\r\n        maxToRenderPerBatch={5}\r\n        windowSize={5}\r\n        onEndReachedThreshold={0.5}\r\n        showsVerticalScrollIndicator={false}\r\n        removeClippedSubviews={true}\r\n        initialScrollIndex={2}\r\n      />\r\n      <Modal\r\n        animationType=\"slide\"\r\n        transparent={true}\r\n        visible={modalVisible}\r\n      >\r\n        <View style={styles.container}>\r\n          <ScrollView showsVerticalScrollIndicator={false} style={styles.modalScrollView}>\r\n            <Text style={styles.modalText}>{format(selectedDate, 'd-MMMM', { locale: ru })}</Text>\r\n            <TasksForSelectedDateComponent\r\n              tasksByClient={tasksBySelectedDate}\r\n              expandedClients={expandedClients}\r\n              toggleClient={handleToggleClient}\r\n            />\r\n          </ScrollView>\r\n        </View>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nVerticalCalendar.propTypes = {\r\n  tasks: PropTypes.array.isRequired,\r\n  taskDates: PropTypes.object.isRequired,\r\n  renderAddButton: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default VerticalCalendar;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}