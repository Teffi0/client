{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"serviceName\"];\nvar _jsxFileName = \"C:\\\\Users\\\\fred\\\\Desktop\\\\client\\\\src\\\\screens\\\\TaskDetailScreen.js\",\n  _this = this;\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nimport React, { useState, useEffect, useCallback } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport styles from '../styles/styles';\nimport { formatDate, formatTime } from '../utils/dateFormatter';\nimport { updateTaskStatus } from '../utils/taskScreenHelpers';\nimport DropdownItem from '../components/DropdownItem';\nimport { fetchTaskParticipants, fetchDraftData } from '../utils/tasks';\nimport { BackIcon, EditIcon, None } from '../icons';\nimport NewTaskScreen from './NewTaskScreen';\nimport * as ImagePicker from 'expo-image-picker';\nvar TaskDetailScreen = function TaskDetailScreen(_ref) {\n  var route = _ref.route;\n  var navigation = useNavigation();\n  var _route$params$params = route.params.params;\n  _route$params$params = _route$params$params === void 0 ? {} : _route$params$params;\n  var serviceName = _route$params$params.serviceName,\n    initialTask = _objectWithoutProperties(_route$params$params, _excluded);\n  var _useState = useState(initialTask),\n    _useState2 = _slicedToArray(_useState, 2),\n    task = _useState2[0],\n    setTask = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isModalVisible = _useState4[0],\n    setModalVisible = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    selectedInventory = _useState6[0],\n    setSelectedInventory = _useState6[1];\n  var _useState7 = useState([]),\n    _useState8 = _slicedToArray(_useState7, 2),\n    inventoryItems = _useState8[0],\n    setInventoryItems = _useState8[1];\n  var _useState9 = useState([]),\n    _useState10 = _slicedToArray(_useState9, 2),\n    taskInventory = _useState10[0],\n    setTaskInventory = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    isNewTaskScreenVisible = _useState12[0],\n    setNewTaskScreenVisible = _useState12[1];\n  var _useState13 = useState(null),\n    _useState14 = _slicedToArray(_useState13, 2),\n    draftData = _useState14[0],\n    setDraftData = _useState14[1];\n  var _useState15 = useState([]),\n    _useState16 = _slicedToArray(_useState15, 2),\n    selectedImages = _useState16[0],\n    setSelectedImages = _useState16[1];\n  var _useState17 = useState(false),\n    _useState18 = _slicedToArray(_useState17, 2),\n    fullScreenImageModalVisible = _useState18[0],\n    setFullScreenImageModalVisible = _useState18[1];\n  var _useState19 = useState(null),\n    _useState20 = _slicedToArray(_useState19, 2),\n    currentImage = _useState20[0],\n    setCurrentImage = _useState20[1];\n  var _useState21 = useState(0),\n    _useState22 = _slicedToArray(_useState21, 2),\n    currentImageIndex = _useState22[0],\n    setCurrentImageIndex = _useState22[1];\n  var openFullScreenImage = function openFullScreenImage(index) {\n    setCurrentImageIndex(index);\n    setFullScreenImageModalVisible(true);\n  };\n  var showNextImage = function showNextImage() {\n    if (currentImageIndex < selectedImages.length - 1) {\n      setCurrentImageIndex(currentImageIndex + 1);\n    }\n  };\n  var showPreviousImage = function showPreviousImage() {\n    if (currentImageIndex > 0) {\n      setCurrentImageIndex(currentImageIndex - 1);\n    }\n  };\n  var FullScreenImageModal = function FullScreenImageModal(_ref2) {\n    var _selectedImages$curre;\n    var isVisible = _ref2.isVisible,\n      onClose = _ref2.onClose;\n    var imageUri = (_selectedImages$curre = selectedImages[currentImageIndex]) == null ? void 0 : _selectedImages$curre.uri;\n    return React.createElement(Modal, {\n      visible: isVisible,\n      transparent: false,\n      animationType: \"fade\",\n      onRequestClose: onClose,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 7\n      }\n    }, React.createElement(View, {\n      style: {\n        flex: 1,\n        backgroundColor: 'black',\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }\n    }, imageUri && React.createElement(Image, {\n      source: {\n        uri: imageUri\n      },\n      style: {\n        width: '100%',\n        height: '100%',\n        resizeMode: 'contain'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 13\n      }\n    }), React.createElement(TouchableOpacity, {\n      style: {\n        position: 'absolute',\n        top: 40,\n        right: 20\n      },\n      onPress: onClose,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 11\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: 'white',\n        fontSize: 30\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 13\n      }\n    }, \"\\xD7\")), currentImageIndex > 0 && React.createElement(TouchableOpacity, {\n      style: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        bottom: 0,\n        right: '50%',\n        justifyContent: 'center'\n      },\n      onPress: showPreviousImage,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: 'white',\n        fontSize: 42,\n        textAlign: 'left',\n        marginLeft: 20\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 15\n      }\n    }, \"\\u2039\")), currentImageIndex < selectedImages.length - 1 && React.createElement(TouchableOpacity, {\n      style: {\n        position: 'absolute',\n        right: 0,\n        top: 0,\n        bottom: 0,\n        left: '50%',\n        justifyContent: 'center'\n      },\n      onPress: showNextImage,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: 'white',\n        fontSize: 42,\n        textAlign: 'right',\n        marginRight: 20\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 15\n      }\n    }, \"\\u203A\"))));\n  };\n  var handleChoosePhoto = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      var permissionResult = yield ImagePicker.requestMediaLibraryPermissionsAsync();\n      if (!permissionResult.granted) {\n        Alert.alert('Уведомление', 'Необходим доступ к фотографиям для загрузки в отчет');\n        return;\n      }\n      try {\n        var pickerResult = yield ImagePicker.launchImageLibraryAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.Images,\n          allowsMultipleSelection: true,\n          quality: 1\n        });\n        if (!pickerResult.canceled) {\n          setSelectedImages(function (prevImages) {\n            return [].concat(_toConsumableArray(prevImages), _toConsumableArray(pickerResult.assets || []));\n          });\n          console.log(selectedImages);\n        }\n      } catch (error) {\n        Alert.alert('Ошибка', 'Произошла ошибка при выборе фотографий');\n      }\n    });\n    return function handleChoosePhoto() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var uploadImages = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      if (selectedImages.length === 0) {\n        Alert.alert('Уведомление', 'Пожалуйста, выберите фотографии для загрузки');\n        return;\n      }\n      var formData = new FormData();\n      selectedImages.forEach(function (image, index) {\n        formData.append('photos', {\n          name: `photo_${index}.jpg`,\n          type: 'image/jpeg',\n          uri: Platform.OS === 'android' ? image.uri : image.uri.replace('file://', '')\n        });\n      });\n      try {\n        var taskId = task.id;\n        var response = yield fetch(`http://31.129.101.174/tasks/${taskId}/photos`, {\n          method: 'POST',\n          body: formData,\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        if (!response.ok) throw new Error('Сетевая ошибка при загрузке изображений');\n        setSelectedImages([]);\n      } catch (error) {\n        Alert.alert('Ошибка', 'Произошла ошибка при загрузке фотографий');\n      }\n    });\n    return function uploadImages() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var handleRemoveImage = function handleRemoveImage(index) {\n    setSelectedImages(function (currentImages) {\n      return currentImages.filter(function (_, i) {\n        return i !== index;\n      });\n    });\n  };\n  var handleCancelTaskPress = function handleCancelTaskPress() {\n    Alert.alert(\"Отмена задачи\", \"Вы уверены, что хотите отменить задачу?\", [{\n      text: \"Нет\",\n      style: \"cancel\"\n    }, {\n      text: \"Да\",\n      onPress: function onPress() {\n        return updateTaskStatusToCancelled();\n      }\n    }]);\n  };\n  var updateTaskStatusToCancelled = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      try {\n        var updatedTask = _objectSpread(_objectSpread({}, task), {}, {\n          status: 'отменено'\n        });\n        yield updateTaskStatus(task.id, updatedTask);\n        setTask(updatedTask);\n        if (isModalVisible) {\n          setModalVisible(false);\n        } else {\n          navigation.goBack();\n        }\n      } catch (error) {\n        console.error('Ошибка при обновлении статуса задачи:', error);\n      }\n    });\n    return function updateTaskStatusToCancelled() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var handleAddTaskPress = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      if (task.status === 'в процессе') {\n        setModalVisible(true);\n      } else {\n        try {\n          var updatedTask = _objectSpread(_objectSpread({}, task), {}, {\n            status: 'в процессе'\n          });\n          yield updateTaskStatus(task.id, updatedTask);\n          setTask(updatedTask);\n          navigation.navigate('Tabs', {\n            screen: 'TasksScreen'\n          });\n        } catch (error) {\n          console.error('Ошибка при обновлении статуса задачи:', error);\n        }\n      }\n    });\n    return function handleAddTaskPress() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var handleBackPress = function handleBackPress() {\n    navigation.goBack();\n  };\n  useEffect(function () {}, [task.id]);\n  useEffect(function () {\n    var fetchTaskInventory = function () {\n      var _ref7 = _asyncToGenerator(function* () {\n        if (task.status === 'выполнено') {\n          try {\n            var response = yield fetch(`http://31.129.101.174/tasks/${task.id}/inventory`);\n            var data = yield response.json();\n            setTaskInventory(data);\n          } catch (error) {\n            console.error('Ошибка при получении расходников для задачи:', error);\n          }\n        }\n      });\n      return function fetchTaskInventory() {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n    fetchTaskInventory();\n  }, [task.status, task.id]);\n  var ImagePreview = function ImagePreview(_ref8) {\n    var images = _ref8.images,\n      onRemovePress = _ref8.onRemovePress;\n    return React.createElement(ScrollView, {\n      horizontal: true,\n      style: styles.imagePreviewContainer,\n      showsHorizontalScrollIndicator: false,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 5\n      }\n    }, images.map(function (image, index) {\n      return React.createElement(View, {\n        key: index,\n        style: styles.imageContainer,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 9\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return openFullScreenImage(index);\n        },\n        style: styles.imagePreview,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 11\n        }\n      }, React.createElement(Image, {\n        source: {\n          uri: image.uri\n        },\n        style: styles.image,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }\n      }), React.createElement(TouchableOpacity, {\n        style: styles.removeIconContainer,\n        onPress: function onPress() {\n          return onRemovePress(index);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 13\n        }\n      }, React.createElement(Text, {\n        style: styles.removeIcon,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 15\n        }\n      }, \"\\xD7\"))));\n    }), React.createElement(TouchableOpacity, {\n      onPress: handleChoosePhoto,\n      style: styles.image,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 7\n      }\n    }, React.createElement(View, {\n      style: styles.photoPickerContainer,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }\n    }, React.createElement(Text, {\n      style: styles.photoPickerPlusIcon,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 11\n      }\n    }, \"+\"))));\n  };\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var data = yield fetchDraftData(task.id);\n      setDraftData(data);\n    })();\n  }, [task.id, task.status]);\n  var handleInventoryChange = function handleInventoryChange(newSelectedInventory) {\n    setSelectedInventory(newSelectedInventory);\n  };\n  var handleEditPress = function handleEditPress() {\n    if (draftData) {\n      setNewTaskScreenVisible(true);\n    } else {\n      navigation.navigate('TaskDetail', {\n        screen: 'TaskDetailScreen',\n        params: _objectSpread(_objectSpread({}, task), {}, {\n          serviceName: serviceName\n        })\n      });\n    }\n  };\n  var getHeaderTitle = function getHeaderTitle() {\n    switch (task.status) {\n      case 'новая':\n        return 'Новая задача';\n      case 'в процессе':\n        return 'Задача в процессе';\n      case 'выполнено':\n        return 'Завершенная задача';\n      default:\n        return 'Детали задачи';\n    }\n  };\n  var completeTask = function () {\n    var _ref10 = _asyncToGenerator(function* () {\n      if (selectedInventory.length === 0) {\n        alert('Выберите инвентарь перед завершением задачи.');\n        return;\n      }\n      try {\n        var updatedTask = _objectSpread(_objectSpread({}, task), {}, {\n          status: 'выполнено'\n        });\n        var statusResponse = yield updateTaskStatus(task.id, updatedTask);\n        var filteredInventory = selectedInventory.filter(function (item) {\n          return item.quantity > 0;\n        });\n        var inventoryResponse = yield fetch(`http://31.129.101.174/tasks/${task.id}/complete`, {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            inventory: filteredInventory.map(function (item) {\n              return {\n                inventory_id: item.id,\n                quantity: item.quantity\n              };\n            })\n          })\n        });\n        if (!inventoryResponse.ok) {\n          throw new Error('Ошибка при обновлении инвентаря');\n        }\n        var inventoryResult = yield inventoryResponse.json();\n        yield uploadImages();\n        setModalVisible(false);\n        navigation.navigate('Tabs', {\n          screen: 'TasksScreen'\n        });\n      } catch (error) {\n        console.error('Ошибка при завершении задачи:', error);\n      }\n    });\n    return function completeTask() {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n  var fetchInventoryItems = function () {\n    var _ref11 = _asyncToGenerator(function* () {\n      try {\n        var response = yield fetch('http://31.129.101.174/inventory');\n        var data = yield response.json();\n        setInventoryItems(data);\n      } catch (error) {\n        console.error('Ошибка при получении инвентаря:', error);\n      }\n    });\n    return function fetchInventoryItems() {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    fetchInventoryItems();\n  }, []);\n  useEffect(function () {\n    var updateTaskDetails = function () {\n      var _ref12 = _asyncToGenerator(function* () {\n        var participants = yield fetchTaskParticipants(task.id);\n        setTask(_objectSpread(_objectSpread({}, task), {}, {\n          employees: participants\n        }));\n      });\n      return function updateTaskDetails() {\n        return _ref12.apply(this, arguments);\n      };\n    }();\n    updateTaskDetails();\n  }, [task.id]);\n  var Section = function Section(_ref13) {\n    var title = _ref13.title,\n      children = _ref13.children;\n    return React.createElement(View, {\n      style: styles.section,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 5\n      }\n    }, React.createElement(Text, {\n      style: styles.sectionTitle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 7\n      }\n    }, title), React.createElement(View, {\n      style: styles.sectionContent,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 7\n      }\n    }, children));\n  };\n  var Row = function Row(_ref14) {\n    var title = _ref14.title,\n      value = _ref14.value;\n    var displayValue = value;\n    if (Array.isArray(value) && value.length > 0 && value[0].hasOwnProperty('full_name')) {\n      displayValue = value.map(function (employee) {\n        return employee.full_name;\n      }).join(', ');\n    }\n    return React.createElement(View, {\n      style: styles.rowStyle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 7\n      }\n    }, React.createElement(Text, {\n      style: styles.rowTitle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }\n    }, title), React.createElement(Text, {\n      style: styles.rowValue,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 9\n      }\n    }, displayValue));\n  };\n  return React.createElement(SafeAreaView, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.contentContainerTask,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 7\n    }\n  }, React.createElement(FullScreenImageModal, {\n    isVisible: fullScreenImageModalVisible,\n    imageUri: currentImage,\n    onClose: function onClose() {\n      return setFullScreenImageModalVisible(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 9\n    }\n  }), React.createElement(View, {\n    style: styles.taskHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 9\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: handleBackPress,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 11\n    }\n  }, React.createElement(BackIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 13\n    }\n  })), React.createElement(Text, {\n    style: [styles.titleMedium, {\n      flex: 1,\n      textAlign: 'center'\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 11\n    }\n  }, getHeaderTitle()), task.status !== 'отменено' ? React.createElement(TouchableOpacity, {\n    onPress: handleEditPress,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 13\n    }\n  }, React.createElement(EditIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 15\n    }\n  })) : React.createElement(None, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 13\n    }\n  })), React.createElement(ScrollView, {\n    contentContainerStyle: styles.scrollViewContent,\n    showsVerticalScrollIndicator: false,\n    overScrollMode: \"never\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: styles.headlineMedium,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 11\n    }\n  }, serviceName), React.createElement(Section, {\n    title: \"\\u041A\\u043B\\u0438\\u0435\\u043D\\u0442\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 11\n    }\n  }, React.createElement(Row, {\n    title: \"\\u0424\\u0418\\u041E:\",\n    value: task.fullname_client,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 13\n    }\n  }), React.createElement(Row, {\n    title: \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\",\n    value: task.phone,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 13\n    }\n  }), React.createElement(Row, {\n    title: \"\\u0410\\u0434\\u0440\\u0435\\u0441:\",\n    value: task.address_client,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 13\n    }\n  })), React.createElement(Section, {\n    title: \"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0430\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 11\n    }\n  }, React.createElement(Row, {\n    title: \"\\u0421\\u043F\\u043E\\u0441\\u043E\\u0431 \\u043E\\u043F\\u043B\\u0430\\u0442\\u044B:\",\n    value: task.payment || 'Не указан',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 13\n    }\n  }), React.createElement(Row, {\n    title: \"\\u0421\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C:\",\n    value: task.cost ? `${task.cost} руб.` : 'Не указана',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 13\n    }\n  })), React.createElement(Section, {\n    title: \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u0430\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 11\n    }\n  }, React.createElement(Row, {\n    title: \"\\u041E\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0435\\u043D\\u043D\\u044B\\u0439:\",\n    value: task.responsible || 'Не назначен',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 13\n    }\n  }), React.createElement(Row, {\n    title: \"\\u0423\\u0447\\u0430\\u0441\\u0442\\u043D\\u0438\\u043A\\u0438:\",\n    value: task.employees || 'Нет информации',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 13\n    }\n  }), React.createElement(Row, {\n    title: \"\\u0414\\u0430\\u0442\\u0430 \\u0438 \\u0432\\u0440\\u0435\\u043C\\u044F \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430:\",\n    value: task.start_date ? `${formatDate(task.start_date)} ${formatTime(task.start_time)}` : 'Не указаны',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 13\n    }\n  }), React.createElement(Row, {\n    title: \"\\u0414\\u0430\\u0442\\u0430 \\u0438 \\u0432\\u0440\\u0435\\u043C\\u044F \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F:\",\n    value: task.end_date ? `${formatDate(task.end_date)} ${formatTime(task.end_time)}` : 'Не указаны',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 13\n    }\n  })), task.status === 'выполнено' && React.createElement(Section, {\n    title: \"\\u0420\\u0430\\u0441\\u0445\\u043E\\u0434\\u043D\\u0438\\u043A\\u0438\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 13\n    }\n  }, taskInventory.length > 0 ? taskInventory.map(function (item, index) {\n    return React.createElement(Row, {\n      key: index,\n      title: item.name,\n      value: `Количество: ${item.quantity}`,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 19\n      }\n    });\n  }) : React.createElement(Text, {\n    style: styles.bodyMedium,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 17\n    }\n  }, \"\\u0420\\u0430\\u0441\\u0445\\u043E\\u0434\\u043D\\u0438\\u043A\\u0438 \\u043D\\u0435 \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u043B\\u0438\\u0441\\u044C.\")), React.createElement(Section, {\n    title: \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: [styles.bodyMedium, {\n      marginBottom: 300\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 13\n    }\n  }, task.description || 'Описание отсутствует.'))), React.createElement(Modal, {\n    visible: isModalVisible,\n    animationType: \"slide\",\n    onRequestClose: function onRequestClose() {\n      return setModalVisible(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 9\n    }\n  }, React.createElement(SafeAreaView, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 11\n    }\n  }, React.createElement(View, {\n    style: styles.contentContainerTask,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: styles.taskHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 432,\n      columnNumber: 15\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return setModalVisible(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 17\n    }\n  }, React.createElement(BackIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 19\n    }\n  })), React.createElement(Text, {\n    style: [styles.titleMedium, {\n      flex: 1,\n      textAlign: 'center'\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 436,\n      columnNumber: 17\n    }\n  }, \" \\u041E\\u0442\\u0447\\u0451\\u0442 \"), React.createElement(TouchableOpacity, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 17\n    }\n  }, React.createElement(None, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 19\n    }\n  }))), React.createElement(View, {\n    style: styles.contentContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 15\n    }\n  }, React.createElement(DropdownItem, {\n    label: \"\\u0420\\u0430\\u0441\\u0445\\u043E\\u0434\\u043D\\u0438\\u043A\\u0438\",\n    options: inventoryItems,\n    selectedValues: selectedInventory,\n    onValueChange: handleInventoryChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 17\n    }\n  }), React.createElement(ImagePreview, {\n    images: selectedImages,\n    onAddPress: handleChoosePhoto,\n    onRemovePress: handleRemoveImage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 17\n    }\n  }), React.createElement(TouchableOpacity, {\n    onPress: uploadImages,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 19\n    }\n  }, \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0438\")), React.createElement(TouchableOpacity, {\n    style: styles.addButton,\n    onPress: completeTask,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: styles.addButtonText,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 19\n    }\n  }, \"\\u0417\\u0430\\u0432\\u0435\\u0440\\u0448\\u0438\\u0442\\u044C \\u0440\\u0430\\u0431\\u043E\\u0442\\u0443\")))))), task.status !== 'выполнено' && task.status !== 'отменено' && React.createElement(React.Fragment, null, React.createElement(TouchableOpacity, {\n    style: [styles.addButton, {\n      marginBottom: 68\n    }],\n    onPress: handleAddTaskPress,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.addButtonText,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 13\n    }\n  }, task.status === 'в процессе' ? 'Добавить расходники' : 'Начать выполнение')), React.createElement(TouchableOpacity, {\n    style: [styles.addButton, {\n      backgroundColor: 'black'\n    }],\n    onPress: handleCancelTaskPress,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 471,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.addButtonText,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 13\n    }\n  }, \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430\\u0434\\u0430\\u0447\\u0443\")))), React.createElement(Modal, {\n    visible: isNewTaskScreenVisible,\n    animationType: \"slide\",\n    onRequestClose: function onRequestClose() {\n      return setNewTaskScreenVisible(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 7\n    }\n  }, React.createElement(NewTaskScreen, {\n    onClose: function onClose() {\n      return setNewTaskScreenVisible(false);\n    },\n    draftData: draftData,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 9\n    }\n  })));\n};\nexport default TaskDetailScreen;","map":{"version":3,"names":["React","useState","useEffect","useCallback","View","Text","TouchableOpacity","ScrollView","Modal","Platform","Alert","Image","SafeAreaView","useNavigation","styles","formatDate","formatTime","updateTaskStatus","DropdownItem","fetchTaskParticipants","fetchDraftData","BackIcon","EditIcon","None","NewTaskScreen","ImagePicker","TaskDetailScreen","_ref","route","navigation","_route$params$params","params","serviceName","initialTask","_objectWithoutProperties","_excluded","_useState","_useState2","_slicedToArray","task","setTask","_useState3","_useState4","isModalVisible","setModalVisible","_useState5","_useState6","selectedInventory","setSelectedInventory","_useState7","_useState8","inventoryItems","setInventoryItems","_useState9","_useState10","taskInventory","setTaskInventory","_useState11","_useState12","isNewTaskScreenVisible","setNewTaskScreenVisible","_useState13","_useState14","draftData","setDraftData","_useState15","_useState16","selectedImages","setSelectedImages","_useState17","_useState18","fullScreenImageModalVisible","setFullScreenImageModalVisible","_useState19","_useState20","currentImage","setCurrentImage","_useState21","_useState22","currentImageIndex","setCurrentImageIndex","openFullScreenImage","index","showNextImage","length","showPreviousImage","FullScreenImageModal","_ref2","_selectedImages$curre","isVisible","onClose","imageUri","uri","createElement","visible","transparent","animationType","onRequestClose","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber","style","flex","backgroundColor","justifyContent","alignItems","source","width","height","resizeMode","position","top","right","onPress","color","fontSize","left","bottom","textAlign","marginLeft","marginRight","handleChoosePhoto","_ref3","_asyncToGenerator","permissionResult","requestMediaLibraryPermissionsAsync","granted","alert","pickerResult","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsMultipleSelection","quality","canceled","prevImages","concat","_toConsumableArray","assets","console","log","error","apply","arguments","uploadImages","_ref4","formData","FormData","forEach","image","append","name","type","OS","replace","taskId","id","response","fetch","method","body","headers","ok","Error","handleRemoveImage","currentImages","filter","_","i","handleCancelTaskPress","text","updateTaskStatusToCancelled","_ref5","updatedTask","_objectSpread","status","goBack","handleAddTaskPress","_ref6","navigate","screen","handleBackPress","fetchTaskInventory","_ref7","data","json","ImagePreview","_ref8","images","onRemovePress","horizontal","imagePreviewContainer","showsHorizontalScrollIndicator","map","key","imageContainer","imagePreview","removeIconContainer","removeIcon","photoPickerContainer","photoPickerPlusIcon","handleInventoryChange","newSelectedInventory","handleEditPress","getHeaderTitle","completeTask","_ref10","statusResponse","filteredInventory","item","quantity","inventoryResponse","JSON","stringify","inventory","inventory_id","inventoryResult","fetchInventoryItems","_ref11","updateTaskDetails","_ref12","participants","employees","Section","_ref13","title","children","section","sectionTitle","sectionContent","Row","_ref14","value","displayValue","Array","isArray","hasOwnProperty","employee","full_name","join","rowStyle","rowTitle","rowValue","container","contentContainerTask","taskHeader","titleMedium","contentContainerStyle","scrollViewContent","showsVerticalScrollIndicator","overScrollMode","headlineMedium","fullname_client","phone","address_client","payment","cost","responsible","start_date","start_time","end_date","end_time","bodyMedium","marginBottom","description","contentContainer","label","options","selectedValues","onValueChange","onAddPress","addButton","addButtonText","Fragment"],"sources":["C:/Users/fred/Desktop/client/src/screens/TaskDetailScreen.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { View, Text, TouchableOpacity, ScrollView, Modal, Platform, Alert, Image } from 'react-native';\r\nimport { SafeAreaView } from 'react-native-safe-area-context';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport styles from '../styles/styles';\r\nimport { formatDate, formatTime } from '../utils/dateFormatter';\r\nimport { updateTaskStatus } from '../utils/taskScreenHelpers';\r\nimport DropdownItem from '../components/DropdownItem';\r\nimport { fetchTaskParticipants, fetchDraftData } from '../utils/tasks';\r\nimport { BackIcon, EditIcon, None } from '../icons';\r\nimport NewTaskScreen from './NewTaskScreen';\r\nimport * as ImagePicker from 'expo-image-picker';\r\n\r\nconst TaskDetailScreen = ({ route }) => {\r\n  const navigation = useNavigation();\r\n  const { params: { serviceName, ...initialTask } = {} } = route.params;\r\n  const [task, setTask] = useState(initialTask);\r\n  const [isModalVisible, setModalVisible] = useState(false);\r\n  const [selectedInventory, setSelectedInventory] = useState([]);\r\n  const [inventoryItems, setInventoryItems] = useState([]);\r\n  const [taskInventory, setTaskInventory] = useState([]);\r\n  const [isNewTaskScreenVisible, setNewTaskScreenVisible] = useState(false);\r\n  const [draftData, setDraftData] = useState(null);\r\n  const [selectedImages, setSelectedImages] = useState([]);\r\n  const [fullScreenImageModalVisible, setFullScreenImageModalVisible] = useState(false);\r\n  const [currentImage, setCurrentImage] = useState(null);\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\r\n\r\n  const openFullScreenImage = (index) => {\r\n    setCurrentImageIndex(index);\r\n    setFullScreenImageModalVisible(true);\r\n  };\r\n\r\n  const showNextImage = () => {\r\n    if (currentImageIndex < selectedImages.length - 1) {\r\n      setCurrentImageIndex(currentImageIndex + 1);\r\n    }\r\n  };\r\n\r\n  const showPreviousImage = () => {\r\n    if (currentImageIndex > 0) {\r\n      setCurrentImageIndex(currentImageIndex - 1);\r\n    }\r\n  };\r\n\r\n  const FullScreenImageModal = ({ isVisible, onClose }) => {\r\n    const imageUri = selectedImages[currentImageIndex]?.uri;\r\n\r\n    return (\r\n      <Modal\r\n        visible={isVisible}\r\n        transparent={false}\r\n        animationType=\"fade\"\r\n        onRequestClose={onClose}\r\n      >\r\n        <View style={{ flex: 1, backgroundColor: 'black', justifyContent: 'center', alignItems: 'center' }}>\r\n          {imageUri && (\r\n            <Image\r\n              source={{ uri: imageUri }}\r\n              style={{ width: '100%', height: '100%', resizeMode: 'contain' }}\r\n            />\r\n          )}\r\n          <TouchableOpacity style={{ position: 'absolute', top: 40, right: 20 }} onPress={onClose}>\r\n            <Text style={{ color: 'white', fontSize: 30 }}>×</Text>\r\n          </TouchableOpacity>\r\n\r\n          {currentImageIndex > 0 && (\r\n            <TouchableOpacity\r\n              style={{ position: 'absolute', left: 0, top: 0, bottom: 0, right: '50%', justifyContent: 'center' }}\r\n              onPress={showPreviousImage}\r\n            >\r\n              <Text style={{ color: 'white', fontSize: 42, textAlign: 'left', marginLeft: 20 }}>‹</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n\r\n          {currentImageIndex < selectedImages.length - 1 && (\r\n            <TouchableOpacity\r\n              style={{ position: 'absolute', right: 0, top: 0, bottom: 0, left: '50%', justifyContent: 'center' }}\r\n              onPress={showNextImage}\r\n            >\r\n              <Text style={{ color: 'white', fontSize: 42, textAlign: 'right', marginRight: 20 }}>›</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n      </Modal>\r\n    );\r\n  };\r\n\r\n  const handleChoosePhoto = async () => {\r\n    const permissionResult = await ImagePicker.requestMediaLibraryPermissionsAsync();\r\n    if (!permissionResult.granted) {\r\n      Alert.alert('Уведомление', 'Необходим доступ к фотографиям для загрузки в отчет');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const pickerResult = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsMultipleSelection: true,\r\n        quality: 1,\r\n      });\r\n\r\n      if (!pickerResult.canceled) {\r\n        setSelectedImages(prevImages => [...prevImages, ...(pickerResult.assets || [])]);\r\n        console.log(selectedImages);\r\n      }\r\n    } catch (error) {\r\n      Alert.alert('Ошибка', 'Произошла ошибка при выборе фотографий');\r\n    }\r\n  };\r\n\r\n  const uploadImages = async () => {\r\n    if (selectedImages.length === 0) {\r\n      Alert.alert('Уведомление', 'Пожалуйста, выберите фотографии для загрузки');\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    selectedImages.forEach((image, index) => {\r\n      formData.append('photos', {\r\n        name: `photo_${index}.jpg`,\r\n        type: 'image/jpeg', // Используем стандартный MIME-тип для JPEG\r\n        uri: Platform.OS === 'android' ? image.uri : image.uri.replace('file://', ''),\r\n      });\r\n    });\r\n\r\n    try {\r\n      // Предполагаем, что taskId доступен в текущем состоянии\r\n      const taskId = task.id; // или получить его из другого источника в зависимости от структуры приложения\r\n\r\n      const response = await fetch(`http://31.129.101.174/tasks/${taskId}/photos`, {\r\n        method: 'POST',\r\n        body: formData,\r\n        headers: { 'Content-Type': 'multipart/form-data' },\r\n      });\r\n\r\n      if (!response.ok) throw new Error('Сетевая ошибка при загрузке изображений');\r\n\r\n      setSelectedImages([]);\r\n    } catch (error) {\r\n      Alert.alert('Ошибка', 'Произошла ошибка при загрузке фотографий');\r\n    }\r\n  };\r\n\r\n  const handleRemoveImage = (index) => {\r\n    setSelectedImages(currentImages => currentImages.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleCancelTaskPress = () => {\r\n    Alert.alert(\r\n      \"Отмена задачи\",\r\n      \"Вы уверены, что хотите отменить задачу?\",\r\n      [\r\n        { text: \"Нет\", style: \"cancel\" },\r\n        { text: \"Да\", onPress: () => updateTaskStatusToCancelled() }\r\n      ]\r\n    );\r\n  };\r\n\r\n  const updateTaskStatusToCancelled = async () => {\r\n    try {\r\n      const updatedTask = { ...task, status: 'отменено' };\r\n      await updateTaskStatus(task.id, updatedTask);\r\n      setTask(updatedTask);\r\n      // После успешного обновления статуса, закрываем текущий экран или модальное окно\r\n      if (isModalVisible) {\r\n        setModalVisible(false);\r\n      } else {\r\n        navigation.goBack();\r\n      }\r\n    } catch (error) {\r\n      console.error('Ошибка при обновлении статуса задачи:', error);\r\n    }\r\n  };\r\n\r\n  const handleAddTaskPress = async () => {\r\n    if (task.status === 'в процессе') {\r\n      setModalVisible(true);\r\n    } else {\r\n      try {\r\n        const updatedTask = { ...task, status: 'в процессе' };\r\n        await updateTaskStatus(task.id, updatedTask); // Отправляем полный объект задачи\r\n        setTask(updatedTask); // Обновляем состояние задачи\r\n        navigation.navigate('Tabs', { screen: 'TasksScreen' });\r\n      } catch (error) {\r\n        console.error('Ошибка при обновлении статуса задачи:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleBackPress = () => {\r\n    navigation.goBack(); // Это вызовет возврат к предыдущему экрану в стеке навигации\r\n  };\r\n\r\n  useEffect(() => {\r\n  }, [task.id]);\r\n\r\n  useEffect(() => {\r\n    const fetchTaskInventory = async () => {\r\n      if (task.status === 'выполнено') {\r\n        try {\r\n          // Предполагается, что у тебя есть эндпойнт для получения инвентаря конкретной задачи\r\n          const response = await fetch(`http://31.129.101.174/tasks/${task.id}/inventory`);\r\n          const data = await response.json();\r\n          setTaskInventory(data);\r\n        } catch (error) {\r\n          console.error('Ошибка при получении расходников для задачи:', error);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchTaskInventory();\r\n  }, [task.status, task.id]);\r\n\r\n  const ImagePreview = ({ images, onRemovePress }) => (\r\n    <ScrollView horizontal style={styles.imagePreviewContainer} showsHorizontalScrollIndicator={false}>\r\n      {images.map((image, index) => (\r\n        <View key={index} style={styles.imageContainer}>\r\n          <TouchableOpacity onPress={() => openFullScreenImage(index)} style={styles.imagePreview}>\r\n            <Image source={{ uri: image.uri }} style={styles.image} />\r\n            <TouchableOpacity style={styles.removeIconContainer} onPress={() => onRemovePress(index)}>\r\n              <Text style={styles.removeIcon}>×</Text>\r\n            </TouchableOpacity>\r\n          </TouchableOpacity>\r\n        </View>\r\n      ))}\r\n      <TouchableOpacity onPress={handleChoosePhoto} style={styles.image}>\r\n        <View style={styles.photoPickerContainer}>\r\n          <Text style={styles.photoPickerPlusIcon}>+</Text>\r\n        </View>\r\n      </TouchableOpacity>\r\n    </ScrollView>\r\n  );\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const data = await fetchDraftData(task.id);\r\n      setDraftData(data);\r\n    })();\r\n  }, [task.id, task.status]);\r\n\r\n  const handleInventoryChange = (newSelectedInventory) => {\r\n    setSelectedInventory(newSelectedInventory);\r\n  };\r\n\r\n  const handleEditPress = () => {\r\n    if (draftData) {\r\n      setNewTaskScreenVisible(true);\r\n    } else {\r\n      navigation.navigate('TaskDetail', {\r\n        screen: 'TaskDetailScreen',\r\n        params: { ...task, serviceName },\r\n      });\r\n    }\r\n  };\r\n\r\n  const getHeaderTitle = () => {\r\n    switch (task.status) {\r\n      case 'новая':\r\n        return 'Новая задача';\r\n      case 'в процессе':\r\n        return 'Задача в процессе';\r\n      case 'выполнено':\r\n        return 'Завершенная задача';\r\n      default:\r\n        return 'Детали задачи'; // Для случая, если статус неизвестен\r\n    }\r\n  };\r\n\r\n  const completeTask = async () => {\r\n    // Проверяем, что выбран хотя бы один инвентарь\r\n    if (selectedInventory.length === 0) {\r\n      alert('Выберите инвентарь перед завершением задачи.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Обновляем статус задачи\r\n      const updatedTask = { ...task, status: 'выполнено' };\r\n      const statusResponse = await updateTaskStatus(task.id, updatedTask);\r\n\r\n      // Фильтруем выбранный инвентарь, исключая элементы с количеством ноль\r\n      const filteredInventory = selectedInventory.filter(item => item.quantity > 0);\r\n\r\n      // Отправляем данные о выбранном инвентаре на сервер\r\n      const inventoryResponse = await fetch(`http://31.129.101.174/tasks/${task.id}/complete`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          inventory: filteredInventory.map(item => ({\r\n            inventory_id: item.id,\r\n            quantity: item.quantity\r\n          })),\r\n        }),\r\n      });\r\n\r\n      if (!inventoryResponse.ok) {\r\n        throw new Error('Ошибка при обновлении инвентаря');\r\n      }\r\n\r\n      // Получаем ответ от сервера\r\n      const inventoryResult = await inventoryResponse.json();\r\n      await uploadImages();\r\n\r\n      // Закрыть модальное окно и перейти к списку задач\r\n      setModalVisible(false);\r\n      navigation.navigate('Tabs', { screen: 'TasksScreen' });\r\n    } catch (error) {\r\n      console.error('Ошибка при завершении задачи:', error);\r\n    }\r\n  };\r\n\r\n  const fetchInventoryItems = async () => {\r\n    try {\r\n      const response = await fetch('http://31.129.101.174/inventory');\r\n      const data = await response.json();\r\n      setInventoryItems(data);\r\n    } catch (error) {\r\n      console.error('Ошибка при получении инвентаря:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchInventoryItems();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Функция для обновления информации о задаче, включая участников\r\n    const updateTaskDetails = async () => {\r\n      const participants = await fetchTaskParticipants(task.id);\r\n      setTask({ ...task, employees: participants });\r\n    };\r\n\r\n    updateTaskDetails();\r\n  }, [task.id]);\r\n\r\n  const Section = ({ title, children }) => (\r\n    <View style={styles.section}>\r\n      <Text style={styles.sectionTitle}>{title}</Text>\r\n      <View style={styles.sectionContent}>\r\n        {children}\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  const Row = ({ title, value }) => {\r\n    let displayValue = value;\r\n\r\n    // Проверяем, является ли value массивом и содержит ли он объекты с полем full_name\r\n    if (Array.isArray(value) && value.length > 0 && value[0].hasOwnProperty('full_name')) {\r\n      displayValue = value.map(employee => employee.full_name).join(', ');\r\n    }\r\n\r\n    return (\r\n      <View style={styles.rowStyle}>\r\n        <Text style={styles.rowTitle}>{title}</Text>\r\n        <Text style={styles.rowValue}>{displayValue}</Text>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <SafeAreaView style={styles.container}>\r\n      <View style={styles.contentContainerTask}>\r\n        <FullScreenImageModal\r\n          isVisible={fullScreenImageModalVisible}\r\n          imageUri={currentImage}\r\n          onClose={() => setFullScreenImageModalVisible(false)}\r\n        />\r\n        <View style={styles.taskHeader}>\r\n          <TouchableOpacity onPress={handleBackPress}>\r\n            <BackIcon />\r\n          </TouchableOpacity>\r\n          <Text style={[styles.titleMedium, { flex: 1, textAlign: 'center' }]}>\r\n            {getHeaderTitle()}\r\n          </Text>\r\n          {task.status !== 'отменено' ? (\r\n            <TouchableOpacity onPress={handleEditPress}>\r\n              <EditIcon />\r\n            </TouchableOpacity>\r\n          ) : (\r\n            <None />\r\n          )}\r\n        </View>\r\n        <ScrollView contentContainerStyle={styles.scrollViewContent} showsVerticalScrollIndicator={false} overScrollMode=\"never\">\r\n          <Text style={styles.headlineMedium}>{serviceName}</Text>\r\n\r\n          <Section title=\"Клиент\">\r\n            <Row title=\"ФИО:\" value={task.fullname_client} />\r\n            <Row title=\"Телефон:\" value={task.phone} />\r\n            <Row title=\"Адрес:\" value={task.address_client} />\r\n          </Section>\r\n\r\n          <Section title=\"Оплата\">\r\n            <Row title=\"Способ оплаты:\" value={task.payment || 'Не указан'} />\r\n            <Row title=\"Стоимость:\" value={task.cost ? `${task.cost} руб.` : 'Не указана'} />\r\n          </Section>\r\n\r\n          <Section title=\"Работа\">\r\n            <Row title=\"Ответственный:\" value={task.responsible || 'Не назначен'} />\r\n            <Row title=\"Участники:\" value={task.employees || 'Нет информации'} />\r\n            <Row title=\"Дата и время начала:\" value={task.start_date ? `${formatDate(task.start_date)} ${formatTime(task.start_time)}` : 'Не указаны'} />\r\n            <Row title=\"Дата и время окончания:\" value={task.end_date ? `${formatDate(task.end_date)} ${formatTime(task.end_time)}` : 'Не указаны'} />\r\n          </Section>\r\n\r\n          {task.status === 'выполнено' && (\r\n            <Section title=\"Расходники\">\r\n              {taskInventory.length > 0 ? (\r\n                taskInventory.map((item, index) => (\r\n                  <Row key={index} title={item.name} value={`Количество: ${item.quantity}`} />\r\n                ))\r\n              ) : (\r\n                <Text style={styles.bodyMedium}>Расходники не использовались.</Text>\r\n              )}\r\n            </Section>\r\n          )}\r\n\r\n          <Section title=\"Описание\">\r\n            <Text style={[styles.bodyMedium, { marginBottom: 300 }]}>{task.description || 'Описание отсутствует.'}</Text>\r\n          </Section>\r\n        </ScrollView>\r\n\r\n        <Modal\r\n          visible={isModalVisible}\r\n          animationType=\"slide\"\r\n          onRequestClose={() => setModalVisible(false)}\r\n        >\r\n          <SafeAreaView style={styles.container}>\r\n            <View style={styles.contentContainerTask}>\r\n              <View style={styles.taskHeader}>\r\n                <TouchableOpacity onPress={() => setModalVisible(false)}>\r\n                  <BackIcon />\r\n                </TouchableOpacity>\r\n                <Text style={[styles.titleMedium, { flex: 1, textAlign: 'center' }]}> Отчёт </Text>\r\n                <TouchableOpacity>\r\n                  <None />\r\n                </TouchableOpacity>\r\n              </View>\r\n              <View style={styles.contentContainer}>\r\n                <DropdownItem\r\n                  label=\"Расходники\"\r\n                  options={inventoryItems}\r\n                  selectedValues={selectedInventory}\r\n                  onValueChange={handleInventoryChange}\r\n                />\r\n                <ImagePreview\r\n                  images={selectedImages}\r\n                  onAddPress={handleChoosePhoto}\r\n                  onRemovePress={handleRemoveImage}\r\n                />\r\n                <TouchableOpacity onPress={uploadImages}>\r\n                  <Text>Загрузить фотографии</Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity style={styles.addButton} onPress={completeTask}>\r\n                  <Text style={styles.addButtonText}>Завершить работу</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          </SafeAreaView>\r\n        </Modal>\r\n\r\n        {task.status !== 'выполнено' && task.status !== 'отменено' && (\r\n          <>\r\n          <TouchableOpacity style={[styles.addButton, { marginBottom: 68 }]} onPress={handleAddTaskPress}>\r\n            <Text style={styles.addButtonText}>\r\n              {task.status === 'в процессе' ? 'Добавить расходники' : 'Начать выполнение'}\r\n            </Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity style={[styles.addButton, { backgroundColor: 'black' }]} onPress={handleCancelTaskPress}>\r\n            <Text style={styles.addButtonText}>Отменить задачу</Text>\r\n          </TouchableOpacity>\r\n        </>\r\n        )}\r\n      </View>\r\n      <Modal\r\n        visible={isNewTaskScreenVisible}\r\n        animationType=\"slide\"\r\n        onRequestClose={() => setNewTaskScreenVisible(false)}\r\n      >\r\n        <NewTaskScreen onClose={() => setNewTaskScreenVisible(false)} draftData={draftData} />\r\n      </Modal>\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nexport default TaskDetailScreen;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}